{"ast":null,"code":"import stringify from 'fast-json-stable-stringify';\nimport BigNumber from 'bignumber.js';\nimport { b58decode, validateAddress, ValidationResult, encodePubKey, encodeKey, validatePublicKey, encodeKeyHash, validateKeyHash, validateSignature, validateChain } from '@taquito/utils';\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\n\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n  };\n\n  return extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nfunction __generator(thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function () {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n\n        case 7:\n          op = _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n\n            _.ops.push(op);\n\n            break;\n          }\n\n          if (t[2]) _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n      }\n\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n}\n\nfunction __values(o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator,\n      m = s && o[s],\n      i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n    next: function () {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n}\n\nfunction __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n}\n\nfunction __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n\n  return ar;\n}\n\nvar _a; // Retrieve a unique symbol associated with the key from the environment\n// Used in order to identify all object that are of type MichelsonMap even if they come from different module\n\n\nvar michelsonMapTypeSymbol = Symbol.for('taquito-michelson-map-type-symbol');\n\nvar isMapType = function (value) {\n  return 'args' in value && Array.isArray(value.args) && value.args.length === 2;\n};\n\nvar MapTypecheckError =\n/** @class */\nfunction () {\n  function MapTypecheckError(value, type, errorType) {\n    this.value = value;\n    this.type = type;\n    this.name = 'MapTypecheckError';\n    this.message = errorType + \" not compliant with underlying michelson type\";\n  }\n\n  return MapTypecheckError;\n}();\n/**\r\n * @description Michelson Map is an abstraction over the michelson native map. It supports complex Pair as key\r\n */\n\n\nvar MichelsonMap =\n/** @class */\nfunction () {\n  /**\r\n   * @param mapType If specified key and value will be type-checked before being added to the map\r\n   *\r\n   * @example new MichelsonMap({ prim: \"map\", args: [{prim: \"string\"}, {prim: \"int\"}]})\r\n   */\n  function MichelsonMap(mapType) {\n    this.valueMap = new Map();\n    this.keyMap = new Map();\n    this[_a] = true;\n\n    if (mapType) {\n      this.setType(mapType);\n    }\n  } // Used to check if an object is a michelson map.\n  // Using instanceof was not working for project that had multiple instance of taquito dependencies\n  // as the class constructor is different\n\n\n  MichelsonMap.isMichelsonMap = function (obj) {\n    return obj && obj[michelsonMapTypeSymbol] === true;\n  };\n\n  MichelsonMap.prototype.setType = function (mapType) {\n    if (!isMapType(mapType)) {\n      throw new Error('mapType is not a valid michelson map type');\n    }\n\n    this.keySchema = new Schema(mapType.args[0]);\n    this.valueSchema = new Schema(mapType.args[1]);\n  };\n\n  MichelsonMap.prototype.removeType = function () {\n    this.keySchema = undefined;\n    this.valueSchema = undefined;\n  };\n\n  MichelsonMap.fromLiteral = function (obj, mapType) {\n    var map = new MichelsonMap(mapType);\n    Object.keys(obj).forEach(function (key) {\n      map.set(key, obj[key]);\n    });\n    return map;\n  };\n\n  MichelsonMap.prototype.typecheckKey = function (key) {\n    if (this.keySchema) {\n      return this.keySchema.Typecheck(key);\n    }\n\n    return true;\n  };\n\n  MichelsonMap.prototype.typecheckValue = function (value) {\n    if (this.valueSchema) {\n      return this.valueSchema.Typecheck(value);\n    }\n\n    return true;\n  };\n\n  MichelsonMap.prototype.assertTypecheckValue = function (value) {\n    if (!this.typecheckValue(value)) {\n      throw new MapTypecheckError(value, this.valueSchema, 'value');\n    }\n  };\n\n  MichelsonMap.prototype.assertTypecheckKey = function (key) {\n    if (!this.typecheckKey(key)) {\n      throw new MapTypecheckError(key, this.keySchema, 'key');\n    }\n  };\n\n  MichelsonMap.prototype.serializeDeterministically = function (key) {\n    return stringify(key);\n  };\n\n  MichelsonMap.prototype.keys = function () {\n    var _b, _c, _d, key, e_1_1;\n\n    var e_1, _e;\n\n    return __generator(this, function (_f) {\n      switch (_f.label) {\n        case 0:\n          _f.trys.push([0, 5, 6, 7]);\n\n          _b = __values(this.entries()), _c = _b.next();\n          _f.label = 1;\n\n        case 1:\n          if (!!_c.done) return [3\n          /*break*/\n          , 4];\n          _d = __read(_c.value, 1), key = _d[0];\n          return [4\n          /*yield*/\n          , key];\n\n        case 2:\n          _f.sent();\n\n          _f.label = 3;\n\n        case 3:\n          _c = _b.next();\n          return [3\n          /*break*/\n          , 1];\n\n        case 4:\n          return [3\n          /*break*/\n          , 7];\n\n        case 5:\n          e_1_1 = _f.sent();\n          e_1 = {\n            error: e_1_1\n          };\n          return [3\n          /*break*/\n          , 7];\n\n        case 6:\n          try {\n            if (_c && !_c.done && (_e = _b.return)) _e.call(_b);\n          } finally {\n            if (e_1) throw e_1.error;\n          }\n\n          return [7\n          /*endfinally*/\n          ];\n\n        case 7:\n          return [2\n          /*return*/\n          ];\n      }\n    });\n  };\n\n  MichelsonMap.prototype.values = function () {\n    var _b, _c, _d, value, e_2_1;\n\n    var e_2, _e;\n\n    return __generator(this, function (_f) {\n      switch (_f.label) {\n        case 0:\n          _f.trys.push([0, 5, 6, 7]);\n\n          _b = __values(this.entries()), _c = _b.next();\n          _f.label = 1;\n\n        case 1:\n          if (!!_c.done) return [3\n          /*break*/\n          , 4];\n          _d = __read(_c.value, 2), value = _d[1];\n          return [4\n          /*yield*/\n          , value];\n\n        case 2:\n          _f.sent();\n\n          _f.label = 3;\n\n        case 3:\n          _c = _b.next();\n          return [3\n          /*break*/\n          , 1];\n\n        case 4:\n          return [3\n          /*break*/\n          , 7];\n\n        case 5:\n          e_2_1 = _f.sent();\n          e_2 = {\n            error: e_2_1\n          };\n          return [3\n          /*break*/\n          , 7];\n\n        case 6:\n          try {\n            if (_c && !_c.done && (_e = _b.return)) _e.call(_b);\n          } finally {\n            if (e_2) throw e_2.error;\n          }\n\n          return [7\n          /*endfinally*/\n          ];\n\n        case 7:\n          return [2\n          /*return*/\n          ];\n      }\n    });\n  };\n\n  MichelsonMap.prototype.entries = function () {\n    var _b, _c, key, e_3_1;\n\n    var e_3, _d;\n\n    return __generator(this, function (_e) {\n      switch (_e.label) {\n        case 0:\n          _e.trys.push([0, 5, 6, 7]);\n\n          _b = __values(this.valueMap.keys()), _c = _b.next();\n          _e.label = 1;\n\n        case 1:\n          if (!!_c.done) return [3\n          /*break*/\n          , 4];\n          key = _c.value;\n          return [4\n          /*yield*/\n          , [this.keyMap.get(key), this.valueMap.get(key)]];\n\n        case 2:\n          _e.sent();\n\n          _e.label = 3;\n\n        case 3:\n          _c = _b.next();\n          return [3\n          /*break*/\n          , 1];\n\n        case 4:\n          return [3\n          /*break*/\n          , 7];\n\n        case 5:\n          e_3_1 = _e.sent();\n          e_3 = {\n            error: e_3_1\n          };\n          return [3\n          /*break*/\n          , 7];\n\n        case 6:\n          try {\n            if (_c && !_c.done && (_d = _b.return)) _d.call(_b);\n          } finally {\n            if (e_3) throw e_3.error;\n          }\n\n          return [7\n          /*endfinally*/\n          ];\n\n        case 7:\n          return [2\n          /*return*/\n          ];\n      }\n    });\n  };\n\n  MichelsonMap.prototype.get = function (key) {\n    this.assertTypecheckKey(key);\n    var strKey = this.serializeDeterministically(key);\n    return this.valueMap.get(strKey);\n  };\n  /**\r\n   *\r\n   * @description Set a key and a value in the MichelsonMap. If the key already exists, override the current value.\r\n   *\r\n   * @example map.set(\"myKey\", \"myValue\") // Using a string as key\r\n   *\r\n   * @example map.set({0: \"test\", 1: \"test1\"}, \"myValue\") // Using a pair as key\r\n   *\r\n   * @warn The same key can be represented in multiple ways, depending on the type of the key. This duplicate key situation will cause a runtime error (duplicate key) when sending the map data to the Tezos RPC node.\r\n   *\r\n   * For example, consider a contract with a map whose key is of type boolean.  If you set the following values in MichelsonMap: map.set(false, \"myValue\") and map.set(null, \"myValue\").\r\n   *\r\n   * You will get two unique entries in the MichelsonMap. These values will both be evaluated as falsy by the MichelsonEncoder and ultimately rejected by the Tezos RPC.\r\n   */\n\n\n  MichelsonMap.prototype.set = function (key, value) {\n    this.assertTypecheckKey(key);\n    this.assertTypecheckValue(value);\n    var strKey = this.serializeDeterministically(key);\n    this.keyMap.set(strKey, key);\n    this.valueMap.set(strKey, value);\n  };\n\n  MichelsonMap.prototype.delete = function (key) {\n    this.assertTypecheckKey(key);\n    this.keyMap.delete(this.serializeDeterministically(key));\n    this.valueMap.delete(this.serializeDeterministically(key));\n  };\n\n  MichelsonMap.prototype.has = function (key) {\n    this.assertTypecheckKey(key);\n    var strKey = this.serializeDeterministically(key);\n    return this.keyMap.has(strKey) && this.valueMap.has(strKey);\n  };\n\n  MichelsonMap.prototype.clear = function () {\n    this.keyMap.clear();\n    this.valueMap.clear();\n  };\n\n  Object.defineProperty(MichelsonMap.prototype, \"size\", {\n    get: function () {\n      return this.keyMap.size;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  MichelsonMap.prototype.forEach = function (cb) {\n    var e_4, _b;\n\n    try {\n      for (var _c = __values(this.entries()), _d = _c.next(); !_d.done; _d = _c.next()) {\n        var _e = __read(_d.value, 2),\n            key = _e[0],\n            value = _e[1];\n\n        cb(value, key, this);\n      }\n    } catch (e_4_1) {\n      e_4 = {\n        error: e_4_1\n      };\n    } finally {\n      try {\n        if (_d && !_d.done && (_b = _c.return)) _b.call(_c);\n      } finally {\n        if (e_4) throw e_4.error;\n      }\n    }\n  };\n\n  return MichelsonMap;\n}();\n\n_a = michelsonMapTypeSymbol;\n\nvar TokenValidationError =\n/** @class */\nfunction () {\n  function TokenValidationError(value, token, baseMessage) {\n    this.value = value;\n    this.token = token;\n    this.name = 'ValidationError';\n    var annot = this.token.annot();\n    var annotText = annot ? \"[\" + annot + \"] \" : '';\n    this.message = \"\" + annotText + baseMessage;\n  }\n\n  return TokenValidationError;\n}();\n\nvar Token =\n/** @class */\nfunction () {\n  function Token(val, idx, fac) {\n    this.val = val;\n    this.idx = idx;\n    this.fac = fac;\n    this.createToken = this.fac;\n  }\n\n  Token.prototype.typeWithoutAnnotations = function () {\n    var removeArgsRec = function (val) {\n      if (val.args) {\n        return {\n          prim: val.prim,\n          args: val.args.map(function (x) {\n            return removeArgsRec(x);\n          })\n        };\n      } else {\n        return {\n          prim: val.prim\n        };\n      }\n    };\n\n    return removeArgsRec(this.val);\n  };\n\n  Token.prototype.annot = function () {\n    return (Array.isArray(this.val.annots) && this.val.annots.length > 0 ? this.val.annots[0] : String(this.idx)).replace(/(%|\\:)(_Liq_entry_)?/, '');\n  };\n\n  Token.prototype.hasAnnotations = function () {\n    return Array.isArray(this.val.annots) && this.val.annots.length;\n  };\n\n  Token.prototype.ExtractSignature = function () {\n    return [[this.ExtractSchema()]];\n  };\n\n  return Token;\n}();\n\nvar ComparableToken =\n/** @class */\nfunction (_super) {\n  __extends(ComparableToken, _super);\n\n  function ComparableToken() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  ComparableToken.prototype.compare = function (o1, o2) {\n    if (o1 === o2) {\n      return 0;\n    }\n\n    return o1 < o2 ? -1 : 1;\n  };\n\n  return ComparableToken;\n}(Token);\n\nvar BigMapValidationError =\n/** @class */\nfunction (_super) {\n  __extends(BigMapValidationError, _super);\n\n  function BigMapValidationError(value, token, message) {\n    var _this = _super.call(this, value, token, message) || this;\n\n    _this.value = value;\n    _this.token = token;\n    _this.name = 'BigMapValidationError';\n    return _this;\n  }\n\n  return BigMapValidationError;\n}(TokenValidationError);\n\nvar BigMapToken =\n/** @class */\nfunction (_super) {\n  __extends(BigMapToken, _super);\n\n  function BigMapToken(val, idx, fac) {\n    var _this = _super.call(this, val, idx, fac) || this;\n\n    _this.val = val;\n    _this.idx = idx;\n    _this.fac = fac;\n    return _this;\n  }\n\n  Object.defineProperty(BigMapToken.prototype, \"ValueSchema\", {\n    get: function () {\n      return this.createToken(this.val.args[1], 0);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(BigMapToken.prototype, \"KeySchema\", {\n    get: function () {\n      return this.createToken(this.val.args[0], 0);\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  BigMapToken.prototype.ExtractSchema = function () {\n    var _a;\n\n    return _a = {}, _a[this.KeySchema.ExtractSchema()] = this.ValueSchema.ExtractSchema(), _a;\n  };\n\n  BigMapToken.prototype.isValid = function (value) {\n    if (MichelsonMap.isMichelsonMap(value)) {\n      return null;\n    }\n\n    return new BigMapValidationError(value, this, 'Value must be a MichelsonMap');\n  };\n\n  BigMapToken.prototype.Encode = function (args) {\n    var _this = this;\n\n    var val = args.pop();\n    var err = this.isValid(val);\n\n    if (err) {\n      throw err;\n    }\n\n    return Array.from(val.keys()).sort(function (a, b) {\n      return _this.KeySchema.compare(a, b);\n    }).map(function (key) {\n      return {\n        prim: 'Elt',\n        args: [_this.KeySchema.EncodeObject(key), _this.ValueSchema.EncodeObject(val.get(key))]\n      };\n    });\n  };\n\n  BigMapToken.prototype.EncodeObject = function (args) {\n    var _this = this;\n\n    var val = args;\n    var err = this.isValid(val);\n\n    if (err) {\n      throw err;\n    }\n\n    return Array.from(val.keys()).sort(function (a, b) {\n      return _this.KeySchema.compare(a, b);\n    }).map(function (key) {\n      return {\n        prim: 'Elt',\n        args: [_this.KeySchema.EncodeObject(key), _this.ValueSchema.EncodeObject(val.get(key))]\n      };\n    });\n  };\n\n  BigMapToken.prototype.Execute = function (val, semantic) {\n    var _this = this;\n\n    if (semantic && semantic[BigMapToken.prim]) {\n      return semantic[BigMapToken.prim](val, this.val);\n    }\n\n    if (Array.isArray(val)) {\n      // Athens is returning an empty array for big map in storage\n      // Internal: In taquito v5 it is still used to decode big map diff (as if they were a regular map)\n      var map_1 = new MichelsonMap(this.val);\n      val.forEach(function (current) {\n        map_1.set(_this.KeySchema.ToKey(current.args[0]), _this.ValueSchema.Execute(current.args[1]));\n      });\n      return map_1;\n    } else if ('int' in val) {\n      // Babylon is returning an int with the big map id in contract storage\n      return val.int;\n    } else {\n      // Unknown case\n      throw new Error(\"Big map is expecting either an array (Athens) or an object with an int property (Babylon). Got \" + JSON.stringify(val));\n    }\n  };\n\n  BigMapToken.prim = 'big_map';\n  return BigMapToken;\n}(Token);\n\nvar OrToken =\n/** @class */\nfunction (_super) {\n  __extends(OrToken, _super);\n\n  function OrToken(val, idx, fac) {\n    var _this = _super.call(this, val, idx, fac) || this;\n\n    _this.val = val;\n    _this.idx = idx;\n    _this.fac = fac;\n    return _this;\n  }\n\n  OrToken.prototype.Encode = function (args) {\n    var label = args[args.length - 1];\n    var leftToken = this.createToken(this.val.args[0], this.idx);\n    var keyCount = 1;\n\n    if (leftToken instanceof OrToken) {\n      keyCount = Object.keys(leftToken.ExtractSchema()).length;\n    }\n\n    var rightToken = this.createToken(this.val.args[1], this.idx + keyCount);\n\n    if (String(leftToken.annot()) === String(label) && !(leftToken instanceof OrToken)) {\n      args.pop();\n      return {\n        prim: 'Left',\n        args: [leftToken.Encode(args)]\n      };\n    } else if (String(rightToken.annot()) === String(label) && !(rightToken instanceof OrToken)) {\n      args.pop();\n      return {\n        prim: 'Right',\n        args: [rightToken.Encode(args)]\n      };\n    } else {\n      if (leftToken instanceof OrToken) {\n        var val = leftToken.Encode(args);\n\n        if (val) {\n          return {\n            prim: 'Left',\n            args: [val]\n          };\n        }\n      }\n\n      if (rightToken instanceof OrToken) {\n        var val = rightToken.Encode(args);\n\n        if (val) {\n          return {\n            prim: 'Right',\n            args: [val]\n          };\n        }\n      }\n\n      return null;\n    }\n  };\n\n  OrToken.prototype.ExtractSignature = function () {\n    var e_1, _a, e_2, _b;\n\n    var leftToken = this.createToken(this.val.args[0], this.idx);\n    var keyCount = 1;\n\n    if (leftToken instanceof OrToken) {\n      keyCount = Object.keys(leftToken.ExtractSchema()).length;\n    }\n\n    var rightToken = this.createToken(this.val.args[1], this.idx + keyCount);\n    var newSig = [];\n\n    if (leftToken instanceof OrToken) {\n      newSig.push.apply(newSig, __spread(leftToken.ExtractSignature()));\n    } else {\n      try {\n        for (var _c = __values(leftToken.ExtractSignature()), _d = _c.next(); !_d.done; _d = _c.next()) {\n          var sig = _d.value;\n          newSig.push(__spread([leftToken.annot()], sig));\n        }\n      } catch (e_1_1) {\n        e_1 = {\n          error: e_1_1\n        };\n      } finally {\n        try {\n          if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n        } finally {\n          if (e_1) throw e_1.error;\n        }\n      }\n    }\n\n    if (rightToken instanceof OrToken) {\n      newSig.push.apply(newSig, __spread(rightToken.ExtractSignature()));\n    } else {\n      try {\n        for (var _e = __values(rightToken.ExtractSignature()), _f = _e.next(); !_f.done; _f = _e.next()) {\n          var sig = _f.value;\n          newSig.push(__spread([rightToken.annot()], sig));\n        }\n      } catch (e_2_1) {\n        e_2 = {\n          error: e_2_1\n        };\n      } finally {\n        try {\n          if (_f && !_f.done && (_b = _e.return)) _b.call(_e);\n        } finally {\n          if (e_2) throw e_2.error;\n        }\n      }\n    }\n\n    return newSig;\n  };\n\n  OrToken.prototype.EncodeObject = function (args) {\n    var label = Object.keys(args)[0];\n    var leftToken = this.createToken(this.val.args[0], this.idx);\n    var keyCount = 1;\n\n    if (leftToken instanceof OrToken) {\n      keyCount = Object.keys(leftToken.ExtractSchema()).length;\n    }\n\n    var rightToken = this.createToken(this.val.args[1], this.idx + keyCount);\n\n    if (String(leftToken.annot()) === String(label) && !(leftToken instanceof OrToken)) {\n      return {\n        prim: 'Left',\n        args: [leftToken.EncodeObject(args[label])]\n      };\n    } else if (String(rightToken.annot()) === String(label) && !(rightToken instanceof OrToken)) {\n      return {\n        prim: 'Right',\n        args: [rightToken.EncodeObject(args[label])]\n      };\n    } else {\n      if (leftToken instanceof OrToken) {\n        var val = leftToken.EncodeObject(args);\n\n        if (val) {\n          return {\n            prim: 'Left',\n            args: [val]\n          };\n        }\n      }\n\n      if (rightToken instanceof OrToken) {\n        var val = rightToken.EncodeObject(args);\n\n        if (val) {\n          return {\n            prim: 'Right',\n            args: [val]\n          };\n        }\n      }\n\n      return null;\n    }\n  };\n\n  OrToken.prototype.Execute = function (val, semantics) {\n    var _a;\n\n    var leftToken = this.createToken(this.val.args[0], this.idx);\n    var keyCount = 1;\n\n    if (leftToken instanceof OrToken) {\n      keyCount = Object.keys(leftToken.ExtractSchema()).length;\n    }\n\n    var rightToken = this.createToken(this.val.args[1], this.idx + keyCount);\n\n    if (val.prim === 'Right') {\n      return rightToken.Execute(val.args[0], semantics);\n    } else if (val.prim === 'Left') {\n      return _a = {}, _a[leftToken.annot()] = leftToken.Execute(val.args[0], semantics), _a;\n    } else {\n      throw new Error(\"Was expecting Left or Right prim but got: \" + val.prim);\n    }\n  };\n\n  OrToken.prototype.traversal = function (getLeftValue, getRightValue, concat) {\n    var _a, _b;\n\n    var leftToken = this.createToken(this.val.args[0], this.idx);\n    var keyCount = 1;\n    var leftValue;\n\n    if (leftToken instanceof OrToken && !leftToken.hasAnnotations()) {\n      leftValue = getLeftValue(leftToken);\n      keyCount = Object.keys(leftToken.ExtractSchema()).length;\n    } else {\n      leftValue = (_a = {}, _a[leftToken.annot()] = getLeftValue(leftToken), _a);\n    }\n\n    var rightToken = this.createToken(this.val.args[1], this.idx + keyCount);\n    var rightValue;\n\n    if (rightToken instanceof OrToken && !rightToken.hasAnnotations()) {\n      rightValue = getRightValue(rightToken);\n    } else {\n      rightValue = (_b = {}, _b[rightToken.annot()] = getRightValue(rightToken), _b);\n    }\n\n    var res = concat(leftValue, rightValue);\n    return res;\n  };\n\n  OrToken.prototype.ExtractSchema = function () {\n    return this.traversal(function (leftToken) {\n      return leftToken.ExtractSchema();\n    }, function (rightToken) {\n      return rightToken.ExtractSchema();\n    }, function (leftValue, rightValue) {\n      return __assign(__assign({}, leftValue), rightValue);\n    });\n  };\n\n  OrToken.prim = 'or';\n  return OrToken;\n}(Token);\n\nvar PairToken =\n/** @class */\nfunction (_super) {\n  __extends(PairToken, _super);\n\n  function PairToken(val, idx, fac) {\n    var _this = _super.call(this, val, idx, fac) || this;\n\n    _this.val = val;\n    _this.idx = idx;\n    _this.fac = fac;\n    return _this;\n  }\n\n  PairToken.prototype.Encode = function (args) {\n    var leftToken = this.createToken(this.val.args[0], this.idx);\n    var keyCount = 1;\n\n    if (leftToken instanceof PairToken) {\n      keyCount = Object.keys(leftToken.ExtractSchema()).length;\n    }\n\n    var rightToken = this.createToken(this.val.args[1], this.idx + keyCount);\n    return {\n      prim: 'Pair',\n      args: [leftToken.Encode(args), rightToken.Encode(args)]\n    };\n  };\n\n  PairToken.prototype.ExtractSignature = function () {\n    var e_1, _a, e_2, _b;\n\n    var leftToken = this.createToken(this.val.args[0], this.idx);\n    var keyCount = 1;\n\n    if (leftToken instanceof OrToken) {\n      keyCount = Object.keys(leftToken.ExtractSchema()).length;\n    }\n\n    var rightToken = this.createToken(this.val.args[1], this.idx + keyCount);\n    var newSig = [];\n\n    try {\n      for (var _c = __values(leftToken.ExtractSignature()), _d = _c.next(); !_d.done; _d = _c.next()) {\n        var leftSig = _d.value;\n\n        try {\n          for (var _e = (e_2 = void 0, __values(rightToken.ExtractSignature())), _f = _e.next(); !_f.done; _f = _e.next()) {\n            var rightSig = _f.value;\n            newSig.push(__spread(leftSig, rightSig));\n          }\n        } catch (e_2_1) {\n          e_2 = {\n            error: e_2_1\n          };\n        } finally {\n          try {\n            if (_f && !_f.done && (_b = _e.return)) _b.call(_e);\n          } finally {\n            if (e_2) throw e_2.error;\n          }\n        }\n      }\n    } catch (e_1_1) {\n      e_1 = {\n        error: e_1_1\n      };\n    } finally {\n      try {\n        if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n      } finally {\n        if (e_1) throw e_1.error;\n      }\n    }\n\n    return newSig;\n  };\n\n  PairToken.prototype.ToBigMapKey = function (val) {\n    return {\n      key: this.EncodeObject(val),\n      type: this.typeWithoutAnnotations()\n    };\n  };\n\n  PairToken.prototype.ToKey = function (val) {\n    return this.Execute(val);\n  };\n\n  PairToken.prototype.EncodeObject = function (args) {\n    var leftToken = this.createToken(this.val.args[0], this.idx);\n    var keyCount = 1;\n\n    if (leftToken instanceof PairToken) {\n      keyCount = Object.keys(leftToken.ExtractSchema()).length;\n    }\n\n    var rightToken = this.createToken(this.val.args[1], this.idx + keyCount);\n    var leftValue;\n\n    if (leftToken instanceof PairToken && !leftToken.hasAnnotations()) {\n      leftValue = args;\n    } else {\n      leftValue = args[leftToken.annot()];\n    }\n\n    var rightValue;\n\n    if (rightToken instanceof PairToken && !rightToken.hasAnnotations()) {\n      rightValue = args;\n    } else {\n      rightValue = args[rightToken.annot()];\n    }\n\n    return {\n      prim: 'Pair',\n      args: [leftToken.EncodeObject(leftValue), rightToken.EncodeObject(rightValue)]\n    };\n  };\n\n  PairToken.prototype.traversal = function (getLeftValue, getRightValue) {\n    var _a, _b;\n\n    var leftToken = this.createToken(this.val.args[0], this.idx);\n    var keyCount = 1;\n    var leftValue;\n\n    if (leftToken instanceof PairToken && !leftToken.hasAnnotations()) {\n      leftValue = getLeftValue(leftToken);\n      keyCount = Object.keys(leftToken.ExtractSchema()).length;\n    } else {\n      leftValue = (_a = {}, _a[leftToken.annot()] = getLeftValue(leftToken), _a);\n    }\n\n    var rightToken = this.createToken(this.val.args[1], this.idx + keyCount);\n    var rightValue;\n\n    if (rightToken instanceof PairToken && !rightToken.hasAnnotations()) {\n      rightValue = getRightValue(rightToken);\n    } else {\n      rightValue = (_b = {}, _b[rightToken.annot()] = getRightValue(rightToken), _b);\n    }\n\n    var res = __assign(__assign({}, leftValue), rightValue);\n\n    return res;\n  };\n\n  PairToken.prototype.Execute = function (val, semantics) {\n    return this.traversal(function (leftToken) {\n      return leftToken.Execute(val.args[0], semantics);\n    }, function (rightToken) {\n      return rightToken.Execute(val.args[1], semantics);\n    });\n  };\n\n  PairToken.prototype.ExtractSchema = function () {\n    return this.traversal(function (leftToken) {\n      return leftToken.ExtractSchema();\n    }, function (rightToken) {\n      return rightToken.ExtractSchema();\n    });\n  };\n\n  PairToken.prototype.compare = function (val1, val2) {\n    var leftToken = this.createToken(this.val.args[0], this.idx);\n    var keyCount = 1;\n\n    if (leftToken instanceof PairToken) {\n      keyCount = Object.keys(leftToken.ExtractSchema()).length;\n    }\n\n    var rightToken = this.createToken(this.val.args[1], this.idx + keyCount);\n\n    var getValue = function (token, args) {\n      if (token instanceof PairToken && !token.hasAnnotations()) {\n        return args;\n      } else {\n        return args[token.annot()];\n      }\n    };\n\n    if (leftToken instanceof ComparableToken && rightToken instanceof ComparableToken) {\n      var result = leftToken.compare(getValue(leftToken, val1), getValue(leftToken, val2));\n\n      if (result === 0) {\n        return rightToken.compare(getValue(rightToken, val1), getValue(rightToken, val2));\n      }\n\n      return result;\n    }\n\n    throw new Error('Not a comparable pair');\n  };\n\n  PairToken.prim = 'pair';\n  return PairToken;\n}(ComparableToken);\n\nvar NatValidationError =\n/** @class */\nfunction (_super) {\n  __extends(NatValidationError, _super);\n\n  function NatValidationError(value, token, message) {\n    var _this = _super.call(this, value, token, message) || this;\n\n    _this.value = value;\n    _this.token = token;\n    _this.name = 'NatValidationError';\n    return _this;\n  }\n\n  return NatValidationError;\n}(TokenValidationError);\n\nvar NatToken =\n/** @class */\nfunction (_super) {\n  __extends(NatToken, _super);\n\n  function NatToken(val, idx, fac) {\n    var _this = _super.call(this, val, idx, fac) || this;\n\n    _this.val = val;\n    _this.idx = idx;\n    _this.fac = fac;\n    return _this;\n  }\n\n  NatToken.prototype.Execute = function (val) {\n    return new BigNumber(val[Object.keys(val)[0]]);\n  };\n\n  NatToken.prototype.Encode = function (args) {\n    var val = args.pop();\n    var err = this.isValid(val);\n\n    if (err) {\n      throw err;\n    }\n\n    return {\n      int: String(val).toString()\n    };\n  };\n\n  NatToken.prototype.isValid = function (val) {\n    var bigNumber = new BigNumber(val);\n\n    if (bigNumber.isNaN()) {\n      return new NatValidationError(val, this, \"Value is not a number: \" + val);\n    } else if (bigNumber.isNegative()) {\n      return new NatValidationError(val, this, \"Value cannot be negative: \" + val);\n    } else {\n      return null;\n    }\n  };\n\n  NatToken.prototype.EncodeObject = function (val) {\n    var err = this.isValid(val);\n\n    if (err) {\n      throw err;\n    }\n\n    return {\n      int: String(val).toString()\n    };\n  };\n\n  NatToken.prototype.ExtractSchema = function () {\n    return NatToken.prim;\n  };\n\n  NatToken.prototype.ToBigMapKey = function (val) {\n    return {\n      key: {\n        int: val\n      },\n      type: {\n        prim: NatToken.prim\n      }\n    };\n  };\n\n  NatToken.prototype.ToKey = function (_a) {\n    var int = _a.int;\n    return int;\n  };\n\n  NatToken.prim = 'nat';\n  return NatToken;\n}(ComparableToken);\n\nvar StringToken =\n/** @class */\nfunction (_super) {\n  __extends(StringToken, _super);\n\n  function StringToken(val, idx, fac) {\n    var _this = _super.call(this, val, idx, fac) || this;\n\n    _this.val = val;\n    _this.idx = idx;\n    _this.fac = fac;\n    return _this;\n  }\n\n  StringToken.prototype.Execute = function (val) {\n    return val[Object.keys(val)[0]];\n  };\n\n  StringToken.prototype.ExtractSchema = function () {\n    return StringToken.prim;\n  };\n\n  StringToken.prototype.Encode = function (args) {\n    var val = args.pop();\n    return {\n      string: val\n    };\n  };\n\n  StringToken.prototype.EncodeObject = function (val) {\n    return {\n      string: val\n    };\n  }; // tslint:disable-next-line: variable-name\n\n\n  StringToken.prototype.ToKey = function (_a) {\n    var string = _a.string;\n    return string;\n  };\n\n  StringToken.prototype.ToBigMapKey = function (val) {\n    return {\n      key: {\n        string: val\n      },\n      type: {\n        prim: StringToken.prim\n      }\n    };\n  };\n\n  StringToken.prim = 'string';\n  return StringToken;\n}(ComparableToken);\n\nvar AddressValidationError =\n/** @class */\nfunction (_super) {\n  __extends(AddressValidationError, _super);\n\n  function AddressValidationError(value, token, message) {\n    var _this = _super.call(this, value, token, message) || this;\n\n    _this.value = value;\n    _this.token = token;\n    _this.name = 'AddressValidationError';\n    return _this;\n  }\n\n  return AddressValidationError;\n}(TokenValidationError);\n\nvar AddressToken =\n/** @class */\nfunction (_super) {\n  __extends(AddressToken, _super);\n\n  function AddressToken(val, idx, fac) {\n    var _this = _super.call(this, val, idx, fac) || this;\n\n    _this.val = val;\n    _this.idx = idx;\n    _this.fac = fac;\n    return _this;\n  }\n\n  AddressToken.prototype.ToBigMapKey = function (val) {\n    var decoded = b58decode(val);\n    return {\n      key: {\n        bytes: decoded\n      },\n      type: {\n        prim: 'bytes'\n      }\n    };\n  };\n\n  AddressToken.prototype.isValid = function (value) {\n    if (validateAddress(value) !== ValidationResult.VALID) {\n      return new AddressValidationError(value, this, \"Address is not valid: \" + value);\n    }\n\n    return null;\n  };\n\n  AddressToken.prototype.Encode = function (args) {\n    var val = args.pop();\n    var err = this.isValid(val);\n\n    if (err) {\n      throw err;\n    }\n\n    return {\n      string: val\n    };\n  };\n\n  AddressToken.prototype.EncodeObject = function (val) {\n    var err = this.isValid(val);\n\n    if (err) {\n      throw err;\n    }\n\n    return {\n      string: val\n    };\n  }; // tslint:disable-next-line: variable-name\n\n\n  AddressToken.prototype.Execute = function (val) {\n    if (val.string) {\n      return val.string;\n    }\n\n    return encodePubKey(val.bytes);\n  };\n\n  AddressToken.prototype.ExtractSchema = function () {\n    return AddressToken.prim;\n  }; // tslint:disable-next-line: variable-name\n\n\n  AddressToken.prototype.ToKey = function (_a) {\n    var bytes = _a.bytes,\n        string = _a.string;\n\n    if (string) {\n      return string;\n    }\n\n    return encodePubKey(bytes);\n  };\n\n  AddressToken.prototype.compare = function (address1, address2) {\n    var isImplicit = function (address) {\n      return address.startsWith('tz');\n    };\n\n    if (isImplicit(address1) && isImplicit(address2)) {\n      return _super.prototype.compare.call(this, address1, address2);\n    } else if (isImplicit(address1)) {\n      return -1;\n    } else if (isImplicit(address2)) {\n      return 1;\n    } else {\n      return _super.prototype.compare.call(this, address1, address2);\n    }\n  };\n\n  AddressToken.prim = 'address';\n  return AddressToken;\n}(ComparableToken);\n\nvar MapValidationError =\n/** @class */\nfunction (_super) {\n  __extends(MapValidationError, _super);\n\n  function MapValidationError(value, token, message) {\n    var _this = _super.call(this, value, token, message) || this;\n\n    _this.value = value;\n    _this.token = token;\n    _this.name = 'MapValidationError';\n    return _this;\n  }\n\n  return MapValidationError;\n}(TokenValidationError);\n\nvar MapToken =\n/** @class */\nfunction (_super) {\n  __extends(MapToken, _super);\n\n  function MapToken(val, idx, fac) {\n    var _this = _super.call(this, val, idx, fac) || this;\n\n    _this.val = val;\n    _this.idx = idx;\n    _this.fac = fac;\n    return _this;\n  }\n\n  Object.defineProperty(MapToken.prototype, \"ValueSchema\", {\n    get: function () {\n      return this.createToken(this.val.args[1], 0);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(MapToken.prototype, \"KeySchema\", {\n    get: function () {\n      return this.createToken(this.val.args[0], 0);\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  MapToken.prototype.isValid = function (value) {\n    if (MichelsonMap.isMichelsonMap(value)) {\n      return null;\n    }\n\n    return new MapValidationError(value, this, 'Value must be a MichelsonMap');\n  };\n\n  MapToken.prototype.Execute = function (val, semantics) {\n    var _this = this;\n\n    var map = new MichelsonMap(this.val);\n    val.forEach(function (current) {\n      map.set(_this.KeySchema.ToKey(current.args[0]), _this.ValueSchema.Execute(current.args[1], semantics));\n    });\n    return map;\n  };\n\n  MapToken.prototype.Encode = function (args) {\n    var _this = this;\n\n    var val = args.pop();\n    var err = this.isValid(val);\n\n    if (err) {\n      throw err;\n    }\n\n    return Array.from(val.keys()).sort(function (a, b) {\n      return _this.KeySchema.compare(a, b);\n    }).map(function (key) {\n      return {\n        prim: 'Elt',\n        args: [_this.KeySchema.EncodeObject(key), _this.ValueSchema.EncodeObject(val.get(key))]\n      };\n    });\n  };\n\n  MapToken.prototype.EncodeObject = function (args) {\n    var _this = this;\n\n    var val = args;\n    var err = this.isValid(val);\n\n    if (err) {\n      throw err;\n    }\n\n    return Array.from(val.keys()).sort(function (a, b) {\n      return _this.KeySchema.compare(a, b);\n    }).map(function (key) {\n      return {\n        prim: 'Elt',\n        args: [_this.KeySchema.EncodeObject(key), _this.ValueSchema.EncodeObject(val.get(key))]\n      };\n    });\n  };\n\n  MapToken.prototype.ExtractSchema = function () {\n    return {\n      map: {\n        key: this.KeySchema.ExtractSchema(),\n        value: this.ValueSchema.ExtractSchema()\n      }\n    };\n  };\n\n  MapToken.prim = 'map';\n  return MapToken;\n}(Token);\n\nvar BoolToken =\n/** @class */\nfunction (_super) {\n  __extends(BoolToken, _super);\n\n  function BoolToken(val, idx, fac) {\n    var _this = _super.call(this, val, idx, fac) || this;\n\n    _this.val = val;\n    _this.idx = idx;\n    _this.fac = fac;\n    return _this;\n  }\n\n  BoolToken.prototype.Execute = function (val) {\n    return String(val.prim).toLowerCase() === 'true' ? true : false;\n  };\n\n  BoolToken.prototype.Encode = function (args) {\n    var val = args.pop();\n    return {\n      prim: val ? 'True' : 'False'\n    };\n  };\n\n  BoolToken.prototype.EncodeObject = function (val) {\n    return {\n      prim: val ? 'True' : 'False'\n    };\n  };\n\n  BoolToken.prototype.ExtractSchema = function () {\n    return BoolToken.prim;\n  };\n\n  BoolToken.prototype.ToBigMapKey = function (val) {\n    return {\n      key: this.EncodeObject(val),\n      type: {\n        prim: BoolToken.prim\n      }\n    };\n  };\n\n  BoolToken.prototype.ToKey = function (val) {\n    return this.EncodeObject(val);\n  };\n\n  BoolToken.prototype.compare = function (val1, val2) {\n    if (val1 && val2 || !val1 && !val2) {\n      return 0;\n    } else if (val1) {\n      return 1;\n    } else {\n      return -1;\n    }\n  };\n\n  BoolToken.prim = 'bool';\n  return BoolToken;\n}(ComparableToken);\n\nvar ContractValidationError =\n/** @class */\nfunction (_super) {\n  __extends(ContractValidationError, _super);\n\n  function ContractValidationError(value, token, message) {\n    var _this = _super.call(this, value, token, message) || this;\n\n    _this.value = value;\n    _this.token = token;\n    _this.name = 'ContractValidationError';\n    return _this;\n  }\n\n  return ContractValidationError;\n}(TokenValidationError);\n\nvar ContractToken =\n/** @class */\nfunction (_super) {\n  __extends(ContractToken, _super);\n\n  function ContractToken(val, idx, fac) {\n    var _this = _super.call(this, val, idx, fac) || this;\n\n    _this.val = val;\n    _this.idx = idx;\n    _this.fac = fac;\n    return _this;\n  }\n\n  ContractToken.prototype.isValid = function (value) {\n    // tz1,tz2 and tz3 seems to be valid contract values (for Unit contract)\n    if (validateAddress(value) !== ValidationResult.VALID) {\n      return new ContractValidationError(value, this, 'Contract address is not valid');\n    }\n\n    return null;\n  };\n\n  ContractToken.prototype.Execute = function (val) {\n    if (val.string) {\n      return val.string;\n    }\n\n    return encodePubKey(val.bytes);\n  };\n\n  ContractToken.prototype.Encode = function (args) {\n    var val = args.pop();\n    var err = this.isValid(val);\n\n    if (err) {\n      throw err;\n    }\n\n    return {\n      string: val\n    };\n  };\n\n  ContractToken.prototype.EncodeObject = function (val) {\n    var err = this.isValid(val);\n\n    if (err) {\n      throw err;\n    }\n\n    return {\n      string: val\n    };\n  };\n\n  ContractToken.prototype.ExtractSchema = function () {\n    return ContractToken.prim;\n  };\n\n  ContractToken.prim = 'contract';\n  return ContractToken;\n}(Token);\n\nvar ListValidationError =\n/** @class */\nfunction (_super) {\n  __extends(ListValidationError, _super);\n\n  function ListValidationError(value, token, message) {\n    var _this = _super.call(this, value, token, message) || this;\n\n    _this.value = value;\n    _this.token = token;\n    _this.name = 'ListValidationError';\n    return _this;\n  }\n\n  return ListValidationError;\n}(TokenValidationError);\n\nvar ListToken =\n/** @class */\nfunction (_super) {\n  __extends(ListToken, _super);\n\n  function ListToken(val, idx, fac) {\n    var _this = _super.call(this, val, idx, fac) || this;\n\n    _this.val = val;\n    _this.idx = idx;\n    _this.fac = fac;\n    return _this;\n  }\n\n  ListToken.prototype.isValid = function (value) {\n    if (Array.isArray(value)) {\n      return null;\n    }\n\n    return new ListValidationError(value, this, 'Value must be an array');\n  };\n\n  ListToken.prototype.Encode = function (args) {\n    var val = args.pop();\n    var err = this.isValid(val);\n\n    if (err) {\n      throw err;\n    }\n\n    var schema = this.createToken(this.val.args[0], 0);\n    return val.reduce(function (prev, current) {\n      return __spread(prev, [schema.EncodeObject(current)]);\n    }, []);\n  };\n\n  ListToken.prototype.Execute = function (val, semantics) {\n    var schema = this.createToken(this.val.args[0], 0);\n    var err = this.isValid(val);\n\n    if (err) {\n      throw err;\n    }\n\n    return val.reduce(function (prev, current) {\n      return __spread(prev, [schema.Execute(current, semantics)]);\n    }, []);\n  };\n\n  ListToken.prototype.EncodeObject = function (args) {\n    var schema = this.createToken(this.val.args[0], 0);\n    var err = this.isValid(args);\n\n    if (err) {\n      throw err;\n    }\n\n    return args.reduce(function (prev, current) {\n      return __spread(prev, [schema.EncodeObject(current)]);\n    }, []);\n  };\n\n  ListToken.prototype.ExtractSchema = function () {\n    return ListToken.prim;\n  };\n\n  ListToken.prim = 'list';\n  return ListToken;\n}(Token);\n\nvar MutezValidationError =\n/** @class */\nfunction (_super) {\n  __extends(MutezValidationError, _super);\n\n  function MutezValidationError(value, token, message) {\n    var _this = _super.call(this, value, token, message) || this;\n\n    _this.value = value;\n    _this.token = token;\n    _this.name = 'MutezValidationError';\n    return _this;\n  }\n\n  return MutezValidationError;\n}(TokenValidationError);\n\nvar MutezToken =\n/** @class */\nfunction (_super) {\n  __extends(MutezToken, _super);\n\n  function MutezToken(val, idx, fac) {\n    var _this = _super.call(this, val, idx, fac) || this;\n\n    _this.val = val;\n    _this.idx = idx;\n    _this.fac = fac;\n    return _this;\n  }\n\n  MutezToken.prototype.Execute = function (val) {\n    return new BigNumber(val[Object.keys(val)[0]]);\n  };\n\n  MutezToken.prototype.ExtractSchema = function () {\n    return MutezToken.prim;\n  };\n\n  MutezToken.prototype.isValid = function (val) {\n    var bigNumber = new BigNumber(val);\n\n    if (bigNumber.isNaN()) {\n      return new MutezValidationError(val, this, \"Value is not a number: \" + val);\n    } else {\n      return null;\n    }\n  };\n\n  MutezToken.prototype.Encode = function (args) {\n    var val = args.pop();\n    var err = this.isValid(val);\n\n    if (err) {\n      throw err;\n    }\n\n    return {\n      int: String(val).toString()\n    };\n  };\n\n  MutezToken.prototype.EncodeObject = function (val) {\n    var err = this.isValid(val);\n\n    if (err) {\n      throw err;\n    }\n\n    return {\n      int: String(val).toString()\n    };\n  };\n\n  MutezToken.prototype.ToBigMapKey = function (val) {\n    return {\n      key: {\n        int: val\n      },\n      type: {\n        prim: MutezToken.prim\n      }\n    };\n  };\n\n  MutezToken.prototype.ToKey = function (_a) {\n    var int = _a.int;\n    return int;\n  };\n\n  MutezToken.prim = 'mutez';\n  return MutezToken;\n}(ComparableToken);\n\nvar BytesValidationError =\n/** @class */\nfunction (_super) {\n  __extends(BytesValidationError, _super);\n\n  function BytesValidationError(value, token, message) {\n    var _this = _super.call(this, value, token, message) || this;\n\n    _this.value = value;\n    _this.token = token;\n    _this.name = 'BytesValidationError';\n    return _this;\n  }\n\n  return BytesValidationError;\n}(TokenValidationError);\n\nvar BytesToken =\n/** @class */\nfunction (_super) {\n  __extends(BytesToken, _super);\n\n  function BytesToken(val, idx, fac) {\n    var _this = _super.call(this, val, idx, fac) || this;\n\n    _this.val = val;\n    _this.idx = idx;\n    _this.fac = fac;\n    return _this;\n  }\n\n  BytesToken.prototype.ToBigMapKey = function (val) {\n    return {\n      key: {\n        bytes: val\n      },\n      type: {\n        prim: BytesToken.prim\n      }\n    };\n  };\n\n  BytesToken.prototype.isValid = function (val) {\n    if (typeof val === 'string' && /^[0-9a-fA-F]*$/.test(val) && val.length % 2 === 0) {\n      return null;\n    } else {\n      return new BytesValidationError(val, this, \"Invalid bytes: \" + val);\n    }\n  };\n\n  BytesToken.prototype.Encode = function (args) {\n    var val = args.pop();\n    var err = this.isValid(val);\n\n    if (err) {\n      throw err;\n    }\n\n    return {\n      bytes: String(val).toString()\n    };\n  };\n\n  BytesToken.prototype.EncodeObject = function (val) {\n    var err = this.isValid(val);\n\n    if (err) {\n      throw err;\n    }\n\n    return {\n      bytes: String(val).toString()\n    };\n  };\n\n  BytesToken.prototype.Execute = function (val) {\n    return val.bytes;\n  };\n\n  BytesToken.prototype.ExtractSchema = function () {\n    return BytesToken.prim;\n  }; // tslint:disable-next-line: variable-name\n\n\n  BytesToken.prototype.ToKey = function (_a) {\n    var bytes = _a.bytes,\n        string = _a.string;\n\n    if (string) {\n      return string;\n    }\n\n    return bytes;\n  };\n\n  BytesToken.prim = 'bytes';\n  return BytesToken;\n}(ComparableToken);\n\nvar OptionToken =\n/** @class */\nfunction (_super) {\n  __extends(OptionToken, _super);\n\n  function OptionToken(val, idx, fac) {\n    var _this = _super.call(this, val, idx, fac) || this;\n\n    _this.val = val;\n    _this.idx = idx;\n    _this.fac = fac;\n    return _this;\n  }\n\n  OptionToken.prototype.subToken = function () {\n    return this.createToken(this.val.args[0], this.idx);\n  };\n\n  OptionToken.prototype.annot = function () {\n    return Array.isArray(this.val.annots) ? _super.prototype.annot.call(this) : this.createToken(this.val.args[0], this.idx).annot();\n  };\n\n  OptionToken.prototype.Encode = function (args) {\n    var value = args;\n\n    if (value === undefined || value === null) {\n      return {\n        prim: 'None'\n      };\n    } else if (Array.isArray(value) && (value[value.length - 1] === undefined || value[value.length - 1] === null)) {\n      value.pop();\n      return {\n        prim: 'None'\n      };\n    }\n\n    var schema = this.createToken(this.val.args[0], 0);\n    return {\n      prim: 'Some',\n      args: [schema.Encode(args)]\n    };\n  };\n\n  OptionToken.prototype.EncodeObject = function (args) {\n    var schema = this.createToken(this.val.args[0], 0);\n    var value = args;\n\n    if (value === undefined || value === null) {\n      return {\n        prim: 'None'\n      };\n    }\n\n    return {\n      prim: 'Some',\n      args: [schema.EncodeObject(value)]\n    };\n  };\n\n  OptionToken.prototype.Execute = function (val, semantics) {\n    if (val.prim === 'None') {\n      return null;\n    }\n\n    var schema = this.createToken(this.val.args[0], 0);\n    return schema.Execute(val.args[0], semantics);\n  };\n\n  OptionToken.prototype.ExtractSchema = function () {\n    var schema = this.createToken(this.val.args[0], 0);\n    return schema.ExtractSchema();\n  };\n\n  OptionToken.prototype.ExtractSignature = function () {\n    var schema = this.createToken(this.val.args[0], 0);\n    return __spread(schema.ExtractSignature(), [[]]);\n  };\n\n  OptionToken.prim = 'option';\n  return OptionToken;\n}(Token);\n\nvar TimestampToken =\n/** @class */\nfunction (_super) {\n  __extends(TimestampToken, _super);\n\n  function TimestampToken(val, idx, fac) {\n    var _this = _super.call(this, val, idx, fac) || this;\n\n    _this.val = val;\n    _this.idx = idx;\n    _this.fac = fac;\n    return _this;\n  }\n\n  TimestampToken.prototype.Execute = function (val) {\n    if (val.string) {\n      return new Date(val.string).toISOString();\n    } else if (val.int) {\n      return new Date(Number(val.int) * 1000).toISOString();\n    }\n  };\n\n  TimestampToken.prototype.Encode = function (args) {\n    var val = args.pop();\n    return {\n      string: val\n    };\n  };\n\n  TimestampToken.prototype.EncodeObject = function (val) {\n    return {\n      string: val\n    };\n  };\n\n  TimestampToken.prototype.ExtractSchema = function () {\n    return TimestampToken.prim;\n  }; // tslint:disable-next-line: variable-name\n\n\n  TimestampToken.prototype.ToKey = function (_a) {\n    var string = _a.string;\n    return string;\n  };\n\n  TimestampToken.prototype.ToBigMapKey = function (val) {\n    return {\n      key: {\n        string: val\n      },\n      type: {\n        prim: TimestampToken.prim\n      }\n    };\n  };\n\n  TimestampToken.prim = 'timestamp';\n  return TimestampToken;\n}(ComparableToken);\n\nvar IntValidationError =\n/** @class */\nfunction (_super) {\n  __extends(IntValidationError, _super);\n\n  function IntValidationError(value, token, message) {\n    var _this = _super.call(this, value, token, message) || this;\n\n    _this.value = value;\n    _this.token = token;\n    _this.name = 'IntValidationError';\n    return _this;\n  }\n\n  return IntValidationError;\n}(TokenValidationError);\n\nvar IntToken =\n/** @class */\nfunction (_super) {\n  __extends(IntToken, _super);\n\n  function IntToken(val, idx, fac) {\n    var _this = _super.call(this, val, idx, fac) || this;\n\n    _this.val = val;\n    _this.idx = idx;\n    _this.fac = fac;\n    return _this;\n  }\n\n  IntToken.prototype.Execute = function (val) {\n    return new BigNumber(val[Object.keys(val)[0]]);\n  };\n\n  IntToken.prototype.ExtractSchema = function () {\n    return IntToken.prim;\n  };\n\n  IntToken.prototype.isValid = function (val) {\n    var bigNumber = new BigNumber(val);\n\n    if (bigNumber.isNaN()) {\n      return new IntValidationError(val, this, \"Value is not a number: \" + val);\n    } else {\n      return null;\n    }\n  };\n\n  IntToken.prototype.Encode = function (args) {\n    var val = args.pop();\n    var err = this.isValid(val);\n\n    if (err) {\n      throw err;\n    }\n\n    return {\n      int: String(val).toString()\n    };\n  };\n\n  IntToken.prototype.EncodeObject = function (val) {\n    var err = this.isValid(val);\n\n    if (err) {\n      throw err;\n    }\n\n    return {\n      int: String(val).toString()\n    };\n  };\n\n  IntToken.prototype.ToBigMapKey = function (val) {\n    return {\n      key: {\n        int: val\n      },\n      type: {\n        prim: IntToken.prim\n      }\n    };\n  };\n\n  IntToken.prototype.ToKey = function (_a) {\n    var int = _a.int;\n    return int;\n  };\n\n  IntToken.prim = 'int';\n  return IntToken;\n}(ComparableToken);\n\nvar UnitToken =\n/** @class */\nfunction (_super) {\n  __extends(UnitToken, _super);\n\n  function UnitToken(val, idx, fac) {\n    var _this = _super.call(this, val, idx, fac) || this;\n\n    _this.val = val;\n    _this.idx = idx;\n    _this.fac = fac;\n    return _this;\n  }\n\n  UnitToken.prototype.Encode = function (args) {\n    args.pop();\n    return {\n      prim: 'Unit'\n    };\n  };\n\n  UnitToken.prototype.EncodeObject = function (_val) {\n    return {\n      prim: 'Unit'\n    };\n  };\n\n  UnitToken.prototype.Execute = function () {\n    return UnitValue;\n  };\n\n  UnitToken.prototype.ExtractSchema = function () {\n    return UnitToken.prim;\n  };\n\n  UnitToken.prim = 'unit';\n  return UnitToken;\n}(Token);\n\nvar KeyValidationError =\n/** @class */\nfunction (_super) {\n  __extends(KeyValidationError, _super);\n\n  function KeyValidationError(value, token, message) {\n    var _this = _super.call(this, value, token, message) || this;\n\n    _this.value = value;\n    _this.token = token;\n    _this.name = 'KeyValidationError';\n    return _this;\n  }\n\n  return KeyValidationError;\n}(TokenValidationError);\n\nvar KeyToken =\n/** @class */\nfunction (_super) {\n  __extends(KeyToken, _super);\n\n  function KeyToken(val, idx, fac) {\n    var _this = _super.call(this, val, idx, fac) || this;\n\n    _this.val = val;\n    _this.idx = idx;\n    _this.fac = fac;\n    return _this;\n  }\n\n  KeyToken.prototype.Execute = function (val) {\n    if (val.string) {\n      return val.string;\n    }\n\n    return encodeKey(val.bytes);\n  };\n\n  KeyToken.prototype.isValid = function (value) {\n    if (validatePublicKey(value) !== ValidationResult.VALID) {\n      return new KeyValidationError(value, this, 'Key is not valid');\n    }\n\n    return null;\n  };\n\n  KeyToken.prototype.Encode = function (args) {\n    var val = args.pop();\n    var err = this.isValid(val);\n\n    if (err) {\n      throw err;\n    }\n\n    return {\n      string: val\n    };\n  };\n\n  KeyToken.prototype.EncodeObject = function (val) {\n    var err = this.isValid(val);\n\n    if (err) {\n      throw err;\n    }\n\n    return {\n      string: val\n    };\n  };\n\n  KeyToken.prototype.ExtractSchema = function () {\n    return KeyToken.prim;\n  };\n\n  KeyToken.prim = 'key';\n  return KeyToken;\n}(Token);\n\nvar KeyHashValidationError =\n/** @class */\nfunction (_super) {\n  __extends(KeyHashValidationError, _super);\n\n  function KeyHashValidationError(value, token, message) {\n    var _this = _super.call(this, value, token, message) || this;\n\n    _this.value = value;\n    _this.token = token;\n    _this.name = 'KeyHashValidationError';\n    return _this;\n  }\n\n  return KeyHashValidationError;\n}(TokenValidationError);\n\nvar KeyHashToken =\n/** @class */\nfunction (_super) {\n  __extends(KeyHashToken, _super);\n\n  function KeyHashToken(val, idx, fac) {\n    var _this = _super.call(this, val, idx, fac) || this;\n\n    _this.val = val;\n    _this.idx = idx;\n    _this.fac = fac;\n    return _this;\n  }\n\n  KeyHashToken.prototype.Execute = function (val) {\n    if (val.string) {\n      return val.string;\n    }\n\n    return encodeKeyHash(val.bytes);\n  };\n\n  KeyHashToken.prototype.isValid = function (value) {\n    if (validateKeyHash(value) !== ValidationResult.VALID) {\n      return new KeyHashValidationError(value, this, \"KeyHash is not valid: \" + value);\n    }\n\n    return null;\n  };\n\n  KeyHashToken.prototype.Encode = function (args) {\n    var val = args.pop();\n    var err = this.isValid(val);\n\n    if (err) {\n      throw err;\n    }\n\n    return {\n      string: val\n    };\n  };\n\n  KeyHashToken.prototype.EncodeObject = function (val) {\n    var err = this.isValid(val);\n\n    if (err) {\n      throw err;\n    }\n\n    return {\n      string: val\n    };\n  };\n\n  KeyHashToken.prototype.ExtractSchema = function () {\n    return KeyHashToken.prim;\n  }; // tslint:disable-next-line: variable-name\n\n\n  KeyHashToken.prototype.ToKey = function (_a) {\n    var string = _a.string,\n        bytes = _a.bytes;\n\n    if (string) {\n      return string;\n    }\n\n    return encodeKeyHash(bytes);\n  };\n\n  KeyHashToken.prototype.ToBigMapKey = function (val) {\n    return {\n      key: {\n        string: val\n      },\n      type: {\n        prim: KeyHashToken.prim\n      }\n    };\n  };\n\n  KeyHashToken.prim = 'key_hash';\n  return KeyHashToken;\n}(ComparableToken);\n\nvar SignatureValidationError =\n/** @class */\nfunction (_super) {\n  __extends(SignatureValidationError, _super);\n\n  function SignatureValidationError(value, token, message) {\n    var _this = _super.call(this, value, token, message) || this;\n\n    _this.value = value;\n    _this.token = token;\n    _this.name = 'SignatureValidationError';\n    return _this;\n  }\n\n  return SignatureValidationError;\n}(TokenValidationError);\n\nvar SignatureToken =\n/** @class */\nfunction (_super) {\n  __extends(SignatureToken, _super);\n\n  function SignatureToken(val, idx, fac) {\n    var _this = _super.call(this, val, idx, fac) || this;\n\n    _this.val = val;\n    _this.idx = idx;\n    _this.fac = fac;\n    return _this;\n  }\n\n  SignatureToken.prototype.Execute = function (val) {\n    return val.string;\n  };\n\n  SignatureToken.prototype.isValid = function (value) {\n    if (validateSignature(value) !== ValidationResult.VALID) {\n      return new SignatureValidationError(value, this, 'Signature is not valid');\n    }\n\n    return null;\n  };\n\n  SignatureToken.prototype.Encode = function (args) {\n    var val = args.pop();\n    var err = this.isValid(val);\n\n    if (err) {\n      throw err;\n    }\n\n    return {\n      string: val\n    };\n  };\n\n  SignatureToken.prototype.EncodeObject = function (val) {\n    var err = this.isValid(val);\n\n    if (err) {\n      throw err;\n    }\n\n    return {\n      string: val\n    };\n  };\n\n  SignatureToken.prototype.ExtractSchema = function () {\n    return SignatureToken.prim;\n  };\n\n  SignatureToken.prim = 'signature';\n  return SignatureToken;\n}(Token);\n\nvar LambdaToken =\n/** @class */\nfunction (_super) {\n  __extends(LambdaToken, _super);\n\n  function LambdaToken(val, idx, fac) {\n    var _this = _super.call(this, val, idx, fac) || this;\n\n    _this.val = val;\n    _this.idx = idx;\n    _this.fac = fac;\n    return _this;\n  }\n\n  LambdaToken.prototype.Execute = function (val) {\n    return val.string;\n  };\n\n  LambdaToken.prototype.Encode = function (args) {\n    var val = args.pop();\n    return val;\n  };\n\n  LambdaToken.prototype.EncodeObject = function (val) {\n    return val;\n  };\n\n  LambdaToken.prototype.ExtractSchema = function () {\n    var _a;\n\n    var leftToken = this.createToken(this.val.args[0], this.idx);\n    var rightToken = this.createToken(this.val.args[1], this.idx + 1);\n    return _a = {}, _a[LambdaToken.prim] = {\n      parameters: leftToken.ExtractSchema(),\n      returns: rightToken.ExtractSchema()\n    }, _a;\n  };\n\n  LambdaToken.prim = 'lambda';\n  return LambdaToken;\n}(Token);\n\nvar OperationToken =\n/** @class */\nfunction (_super) {\n  __extends(OperationToken, _super);\n\n  function OperationToken(val, idx, fac) {\n    var _this = _super.call(this, val, idx, fac) || this;\n\n    _this.val = val;\n    _this.idx = idx;\n    _this.fac = fac;\n    return _this;\n  }\n\n  OperationToken.prototype.Execute = function (val) {\n    return val.string;\n  };\n\n  OperationToken.prototype.Encode = function () {\n    var args = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n\n    var val = args.pop();\n    return {\n      string: val\n    };\n  };\n\n  OperationToken.prototype.EncodeObject = function (val) {\n    return {\n      string: val\n    };\n  };\n\n  OperationToken.prototype.ExtractSchema = function () {\n    return OperationToken.prim;\n  };\n\n  OperationToken.prim = 'operation';\n  return OperationToken;\n}(Token);\n\nvar SetValidationError =\n/** @class */\nfunction (_super) {\n  __extends(SetValidationError, _super);\n\n  function SetValidationError(value, token, message) {\n    var _this = _super.call(this, value, token, message) || this;\n\n    _this.value = value;\n    _this.token = token;\n    _this.name = 'SetValidationError';\n    return _this;\n  }\n\n  return SetValidationError;\n}(TokenValidationError);\n\nvar SetToken =\n/** @class */\nfunction (_super) {\n  __extends(SetToken, _super);\n\n  function SetToken(val, idx, fac) {\n    var _this = _super.call(this, val, idx, fac) || this;\n\n    _this.val = val;\n    _this.idx = idx;\n    _this.fac = fac;\n    return _this;\n  }\n\n  Object.defineProperty(SetToken.prototype, \"KeySchema\", {\n    get: function () {\n      return this.createToken(this.val.args[0], 0);\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  SetToken.prototype.isValid = function (value) {\n    if (Array.isArray(value)) {\n      return null;\n    }\n\n    return new SetValidationError(value, this, 'Value must be an array');\n  };\n\n  SetToken.prototype.Encode = function (args) {\n    var _this = this;\n\n    var val = args.pop();\n    var err = this.isValid(val);\n\n    if (err) {\n      throw err;\n    }\n\n    return val.sort(function (a, b) {\n      return _this.KeySchema.compare(a, b);\n    }).reduce(function (prev, current) {\n      return __spread(prev, [_this.KeySchema.EncodeObject(current)]);\n    }, []);\n  };\n\n  SetToken.prototype.Execute = function (val, semantics) {\n    var _this = this;\n\n    return val.reduce(function (prev, current) {\n      return __spread(prev, [_this.KeySchema.Execute(current, semantics)]);\n    }, []);\n  };\n\n  SetToken.prototype.EncodeObject = function (args) {\n    var _this = this;\n\n    var err = this.isValid(args);\n\n    if (err) {\n      throw err;\n    }\n\n    return args.sort(function (a, b) {\n      return _this.KeySchema.compare(a, b);\n    }).reduce(function (prev, current) {\n      return __spread(prev, [_this.KeySchema.EncodeObject(current)]);\n    }, []);\n  };\n\n  SetToken.prototype.ExtractSchema = function () {\n    return SetToken.prim;\n  };\n\n  SetToken.prim = 'set';\n  return SetToken;\n}(Token);\n\nvar ChainIDValidationError =\n/** @class */\nfunction (_super) {\n  __extends(ChainIDValidationError, _super);\n\n  function ChainIDValidationError(value, token, message) {\n    var _this = _super.call(this, value, token, message) || this;\n\n    _this.value = value;\n    _this.token = token;\n    _this.name = 'ChainIDValidationError';\n    return _this;\n  }\n\n  return ChainIDValidationError;\n}(TokenValidationError);\n\nvar ChainIDToken =\n/** @class */\nfunction (_super) {\n  __extends(ChainIDToken, _super);\n\n  function ChainIDToken(val, idx, fac) {\n    var _this = _super.call(this, val, idx, fac) || this;\n\n    _this.val = val;\n    _this.idx = idx;\n    _this.fac = fac;\n    return _this;\n  }\n\n  ChainIDToken.prototype.isValid = function (value) {\n    if (validateChain(value) !== ValidationResult.VALID) {\n      return new ChainIDValidationError(value, this, 'ChainID is not valid');\n    }\n\n    return null;\n  };\n\n  ChainIDToken.prototype.Execute = function (val) {\n    return val[Object.keys(val)[0]];\n  };\n\n  ChainIDToken.prototype.ExtractSchema = function () {\n    return ChainIDToken.prim;\n  };\n\n  ChainIDToken.prototype.Encode = function (args) {\n    var val = args.pop();\n    var err = this.isValid(val);\n\n    if (err) {\n      throw err;\n    }\n\n    return {\n      string: val\n    };\n  };\n\n  ChainIDToken.prototype.EncodeObject = function (val) {\n    var err = this.isValid(val);\n\n    if (err) {\n      throw err;\n    }\n\n    return {\n      string: val\n    };\n  }; // tslint:disable-next-line: variable-name\n\n\n  ChainIDToken.prototype.ToKey = function (_a) {\n    var string = _a.string;\n    return string;\n  };\n\n  ChainIDToken.prototype.ToBigMapKey = function (val) {\n    return {\n      key: {\n        string: val\n      },\n      type: {\n        prim: ChainIDToken.prim\n      }\n    };\n  };\n\n  ChainIDToken.prim = 'chain_id';\n  return ChainIDToken;\n}(ComparableToken);\n\nvar tokens = [PairToken, NatToken, StringToken, BigMapToken, AddressToken, MapToken, BoolToken, OrToken, ContractToken, ListToken, MutezToken, BytesToken, OptionToken, TimestampToken, IntToken, UnitToken, KeyToken, KeyHashToken, SignatureToken, LambdaToken, OperationToken, SetToken, ChainIDToken];\n\nvar InvalidTokenError =\n/** @class */\nfunction () {\n  function InvalidTokenError(message, data) {\n    this.message = message;\n    this.data = data;\n    this.name = 'Invalid token error';\n  }\n\n  return InvalidTokenError;\n}();\n\nfunction createToken(val, idx) {\n  var t = tokens.find(function (x) {\n    return x.prim === val.prim;\n  });\n\n  if (!t) {\n    throw new InvalidTokenError('Malformed data expected a value with a valid prim property', val);\n  }\n\n  return new t(val, idx, createToken);\n}\n\nvar _a$1;\n\nvar schemaTypeSymbol = Symbol.for('taquito-schema-type-symbol');\n/**\r\n * @warn Our current smart contract abstraction feature is currently in preview. It's API is not final, and it may not cover every use case (yet). We will greatly appreciate any feedback on this feature.\r\n */\n\nvar Schema =\n/** @class */\nfunction () {\n  function Schema(val) {\n    this[_a$1] = true;\n    this.root = createToken(val, 0);\n\n    if (this.root instanceof BigMapToken) {\n      this.bigMap = this.root;\n    } else if (this.isExpressionExtended(val) && val.prim === 'pair') {\n      var exp = val.args[0];\n\n      if (this.isExpressionExtended(exp) && exp.prim === 'big_map') {\n        this.bigMap = new BigMapToken(exp, 0, createToken);\n      }\n    }\n  }\n\n  Schema.isSchema = function (obj) {\n    return obj && obj[schemaTypeSymbol] === true;\n  };\n\n  Schema.fromRPCResponse = function (val) {\n    var storage = val && val.script && Array.isArray(val.script.code) && val.script.code.find(function (x) {\n      return x.prim === 'storage';\n    });\n\n    if (!storage || !Array.isArray(storage.args)) {\n      throw new Error('Invalid rpc response passed as arguments');\n    }\n\n    return new Schema(storage.args[0]);\n  };\n\n  Schema.prototype.isExpressionExtended = function (val) {\n    return 'prim' in val && Array.isArray(val.args);\n  };\n\n  Schema.prototype.removeTopLevelAnnotation = function (obj) {\n    // PairToken and OrToken can have redundant top level annotation in their storage\n    if (this.root instanceof PairToken || this.root instanceof OrToken) {\n      if (this.root.hasAnnotations() && typeof obj === 'object' && Object.keys(obj).length === 1) {\n        return obj[Object.keys(obj)[0]];\n      }\n    }\n\n    return obj;\n  };\n\n  Schema.prototype.Execute = function (val, semantics) {\n    var storage = this.root.Execute(val, semantics);\n    return this.removeTopLevelAnnotation(storage);\n  };\n\n  Schema.prototype.Typecheck = function (val) {\n    try {\n      this.root.EncodeObject(val);\n      return true;\n    } catch (ex) {\n      return false;\n    }\n  };\n\n  Schema.prototype.ExecuteOnBigMapDiff = function (diff, semantics) {\n    if (!this.bigMap) {\n      throw new Error('No big map schema');\n    }\n\n    if (!Array.isArray(diff)) {\n      throw new Error('Invalid big map diff. It must be an array');\n    }\n\n    var eltFormat = diff.map(function (_b) {\n      var key = _b.key,\n          value = _b.value;\n      return {\n        args: [key, value]\n      };\n    });\n    return this.bigMap.Execute(eltFormat, semantics);\n  };\n\n  Schema.prototype.ExecuteOnBigMapValue = function (key, semantics) {\n    if (!this.bigMap) {\n      throw new Error('No big map schema');\n    }\n\n    return this.bigMap.ValueSchema.Execute(key, semantics);\n  };\n\n  Schema.prototype.EncodeBigMapKey = function (key) {\n    if (!this.bigMap) {\n      throw new Error('No big map schema');\n    }\n\n    try {\n      return this.bigMap.KeySchema.ToBigMapKey(key);\n    } catch (ex) {\n      throw new Error('Unable to encode big map key: ' + ex);\n    }\n  };\n\n  Schema.prototype.Encode = function (_value) {\n    try {\n      return this.root.EncodeObject(_value);\n    } catch (ex) {\n      if (ex instanceof TokenValidationError) {\n        throw ex;\n      }\n\n      throw new Error(\"Unable to encode storage object. \" + ex);\n    }\n  };\n\n  Schema.prototype.ExtractSchema = function () {\n    return this.removeTopLevelAnnotation(this.root.ExtractSchema());\n  };\n  /**\r\n   * @deprecated\r\n   */\n\n\n  Schema.prototype.ComputeState = function (tx, state) {\n    var _b;\n\n    var _this = this;\n\n    if (!this.bigMap) {\n      throw new Error('No big map schema');\n    }\n\n    var bigMap = tx.reduce(function (prev, current) {\n      return __assign(__assign({}, prev), _this.ExecuteOnBigMapDiff(current.contents[0].metadata.operation_result.big_map_diff));\n    }, {});\n    return __assign(__assign({}, this.Execute(state)), (_b = {}, _b[this.bigMap.annot()] = bigMap, _b));\n  };\n\n  return Schema;\n}();\n\n_a$1 = schemaTypeSymbol;\n/**\r\n * @warn Our current smart contract abstraction feature is currently in preview. It's API is not final, and it may not cover every use case (yet). We will greatly appreciate any feedback on this feature.\r\n */\n\nvar ParameterSchema =\n/** @class */\nfunction () {\n  function ParameterSchema(val) {\n    this.root = createToken(val, 0);\n  }\n\n  ParameterSchema.fromRPCResponse = function (val) {\n    var parameter = val && val.script && Array.isArray(val.script.code) && val.script.code.find(function (x) {\n      return x.prim === 'parameter';\n    });\n\n    if (!parameter || !Array.isArray(parameter.args)) {\n      throw new Error('Invalid rpc response passed as arguments');\n    }\n\n    return new ParameterSchema(parameter.args[0]);\n  };\n\n  Object.defineProperty(ParameterSchema.prototype, \"isMultipleEntryPoint\", {\n    get: function () {\n      return this.root instanceof OrToken || this.root instanceof OptionToken && this.root.subToken() instanceof OrToken;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(ParameterSchema.prototype, \"hasAnnotation\", {\n    get: function () {\n      if (this.isMultipleEntryPoint) {\n        return Object.keys(this.ExtractSchema())[0] !== '0';\n      } else {\n        return true;\n      }\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  ParameterSchema.prototype.Execute = function (val, semantics) {\n    return this.root.Execute(val, semantics);\n  };\n\n  ParameterSchema.prototype.Encode = function () {\n    var args = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n\n    try {\n      return this.root.Encode(args.reverse());\n    } catch (ex) {\n      if (ex instanceof TokenValidationError) {\n        throw ex;\n      }\n\n      throw new Error(\"Unable to encode storage object. \" + ex);\n    }\n  };\n\n  ParameterSchema.prototype.ExtractSchema = function () {\n    return this.root.ExtractSchema();\n  };\n\n  ParameterSchema.prototype.ExtractSignatures = function () {\n    return this.root.ExtractSignature();\n  };\n\n  return ParameterSchema;\n}();\n\nvar UnitValue = Symbol();\nexport { AddressValidationError, BigMapValidationError, BytesValidationError, ChainIDValidationError, ContractValidationError, IntValidationError, KeyHashValidationError, KeyValidationError, ListValidationError, MapTypecheckError, MapValidationError, MichelsonMap, MutezValidationError, NatValidationError, ParameterSchema, Schema, SetValidationError, SignatureValidationError, UnitValue };","map":{"version":3,"mappings":"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","names":["stringify","BigNumber","b58decode","validateAddress","ValidationResult","encodePubKey","encodeKey","validatePublicKey","encodeKeyHash","validateKeyHash","validateSignature","validateChain","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__extends","__","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","__generator","thisArg","body","_","label","sent","trys","ops","f","y","g","next","verb","Symbol","iterator","v","step","op","TypeError","done","value","pop","push","e","__values","o","m","__read","r","ar","error","__spread","concat","_a","michelsonMapTypeSymbol","for","isMapType","isArray","args","MapTypecheckError","type","errorType","name","message","MichelsonMap","mapType","valueMap","Map","keyMap","setType","isMichelsonMap","obj","Error","keySchema","Schema","valueSchema","removeType","undefined","fromLiteral","map","keys","forEach","key","set","typecheckKey","Typecheck","typecheckValue","assertTypecheckValue","assertTypecheckKey","serializeDeterministically","_b","_c","_d","e_1_1","e_1","_e","_f","entries","return","values","e_2_1","e_2","e_3_1","e_3","get","strKey","delete","has","clear","defineProperty","size","enumerable","configurable","cb","e_4","e_4_1","TokenValidationError","token","baseMessage","annot","annotText","Token","val","idx","fac","createToken","typeWithoutAnnotations","removeArgsRec","prim","x","annots","String","replace","hasAnnotations","ExtractSignature","ExtractSchema","ComparableToken","_super","compare","o1","o2","BigMapValidationError","_this","BigMapToken","KeySchema","ValueSchema","isValid","Encode","err","from","sort","a","EncodeObject","Execute","semantic","map_1","current","ToKey","int","JSON","OrToken","leftToken","keyCount","rightToken","newSig","sig","semantics","traversal","getLeftValue","getRightValue","leftValue","rightValue","res","PairToken","leftSig","rightSig","ToBigMapKey","val1","val2","getValue","result","NatValidationError","NatToken","toString","bigNumber","isNaN","isNegative","StringToken","string","AddressValidationError","AddressToken","decoded","bytes","VALID","address1","address2","isImplicit","address","startsWith","MapValidationError","MapToken","BoolToken","toLowerCase","ContractValidationError","ContractToken","ListValidationError","ListToken","schema","reduce","prev","MutezValidationError","MutezToken","BytesValidationError","BytesToken","test","OptionToken","subToken","TimestampToken","Date","toISOString","Number","IntValidationError","IntToken","UnitToken","_val","UnitValue","KeyValidationError","KeyToken","KeyHashValidationError","KeyHashToken","SignatureValidationError","SignatureToken","LambdaToken","parameters","returns","OperationToken","_i","SetValidationError","SetToken","ChainIDValidationError","ChainIDToken","tokens","InvalidTokenError","data","find","_a$1","schemaTypeSymbol","root","bigMap","isExpressionExtended","exp","isSchema","fromRPCResponse","storage","script","code","removeTopLevelAnnotation","ex","ExecuteOnBigMapDiff","diff","eltFormat","ExecuteOnBigMapValue","EncodeBigMapKey","_value","ComputeState","tx","state","contents","metadata","operation_result","big_map_diff","ParameterSchema","parameter","isMultipleEntryPoint","reverse","ExtractSignatures"],"sources":["D:/work/projects/plenty/falcon-heavy-frontend/node_modules/@taquito/beacon-wallet/node_modules/@taquito/michelson-encoder/dist/taquito-michelson-encoder.es5.js"],"sourcesContent":["import stringify from 'fast-json-stable-stringify';\nimport BigNumber from 'bignumber.js';\nimport { b58decode, validateAddress, ValidationResult, encodePubKey, encodeKey, validatePublicKey, encodeKeyHash, validateKeyHash, validateSignature, validateChain } from '@taquito/utils';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\nfunction __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nfunction __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nfunction __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nfunction __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\n\nvar _a;\r\n// Retrieve a unique symbol associated with the key from the environment\r\n// Used in order to identify all object that are of type MichelsonMap even if they come from different module\r\nvar michelsonMapTypeSymbol = Symbol.for('taquito-michelson-map-type-symbol');\r\nvar isMapType = function (value) {\r\n    return 'args' in value && Array.isArray(value.args) && value.args.length === 2;\r\n};\r\nvar MapTypecheckError = /** @class */ (function () {\r\n    function MapTypecheckError(value, type, errorType) {\r\n        this.value = value;\r\n        this.type = type;\r\n        this.name = 'MapTypecheckError';\r\n        this.message = errorType + \" not compliant with underlying michelson type\";\r\n    }\r\n    return MapTypecheckError;\r\n}());\r\n/**\r\n * @description Michelson Map is an abstraction over the michelson native map. It supports complex Pair as key\r\n */\r\nvar MichelsonMap = /** @class */ (function () {\r\n    /**\r\n     * @param mapType If specified key and value will be type-checked before being added to the map\r\n     *\r\n     * @example new MichelsonMap({ prim: \"map\", args: [{prim: \"string\"}, {prim: \"int\"}]})\r\n     */\r\n    function MichelsonMap(mapType) {\r\n        this.valueMap = new Map();\r\n        this.keyMap = new Map();\r\n        this[_a] = true;\r\n        if (mapType) {\r\n            this.setType(mapType);\r\n        }\r\n    }\r\n    // Used to check if an object is a michelson map.\r\n    // Using instanceof was not working for project that had multiple instance of taquito dependencies\r\n    // as the class constructor is different\r\n    MichelsonMap.isMichelsonMap = function (obj) {\r\n        return obj && obj[michelsonMapTypeSymbol] === true;\r\n    };\r\n    MichelsonMap.prototype.setType = function (mapType) {\r\n        if (!isMapType(mapType)) {\r\n            throw new Error('mapType is not a valid michelson map type');\r\n        }\r\n        this.keySchema = new Schema(mapType.args[0]);\r\n        this.valueSchema = new Schema(mapType.args[1]);\r\n    };\r\n    MichelsonMap.prototype.removeType = function () {\r\n        this.keySchema = undefined;\r\n        this.valueSchema = undefined;\r\n    };\r\n    MichelsonMap.fromLiteral = function (obj, mapType) {\r\n        var map = new MichelsonMap(mapType);\r\n        Object.keys(obj).forEach(function (key) {\r\n            map.set(key, obj[key]);\r\n        });\r\n        return map;\r\n    };\r\n    MichelsonMap.prototype.typecheckKey = function (key) {\r\n        if (this.keySchema) {\r\n            return this.keySchema.Typecheck(key);\r\n        }\r\n        return true;\r\n    };\r\n    MichelsonMap.prototype.typecheckValue = function (value) {\r\n        if (this.valueSchema) {\r\n            return this.valueSchema.Typecheck(value);\r\n        }\r\n        return true;\r\n    };\r\n    MichelsonMap.prototype.assertTypecheckValue = function (value) {\r\n        if (!this.typecheckValue(value)) {\r\n            throw new MapTypecheckError(value, this.valueSchema, 'value');\r\n        }\r\n    };\r\n    MichelsonMap.prototype.assertTypecheckKey = function (key) {\r\n        if (!this.typecheckKey(key)) {\r\n            throw new MapTypecheckError(key, this.keySchema, 'key');\r\n        }\r\n    };\r\n    MichelsonMap.prototype.serializeDeterministically = function (key) {\r\n        return stringify(key);\r\n    };\r\n    MichelsonMap.prototype.keys = function () {\r\n        var _b, _c, _d, key, e_1_1;\r\n        var e_1, _e;\r\n        return __generator(this, function (_f) {\r\n            switch (_f.label) {\r\n                case 0:\r\n                    _f.trys.push([0, 5, 6, 7]);\r\n                    _b = __values(this.entries()), _c = _b.next();\r\n                    _f.label = 1;\r\n                case 1:\r\n                    if (!!_c.done) return [3 /*break*/, 4];\r\n                    _d = __read(_c.value, 1), key = _d[0];\r\n                    return [4 /*yield*/, key];\r\n                case 2:\r\n                    _f.sent();\r\n                    _f.label = 3;\r\n                case 3:\r\n                    _c = _b.next();\r\n                    return [3 /*break*/, 1];\r\n                case 4: return [3 /*break*/, 7];\r\n                case 5:\r\n                    e_1_1 = _f.sent();\r\n                    e_1 = { error: e_1_1 };\r\n                    return [3 /*break*/, 7];\r\n                case 6:\r\n                    try {\r\n                        if (_c && !_c.done && (_e = _b.return)) _e.call(_b);\r\n                    }\r\n                    finally { if (e_1) throw e_1.error; }\r\n                    return [7 /*endfinally*/];\r\n                case 7: return [2 /*return*/];\r\n            }\r\n        });\r\n    };\r\n    MichelsonMap.prototype.values = function () {\r\n        var _b, _c, _d, value, e_2_1;\r\n        var e_2, _e;\r\n        return __generator(this, function (_f) {\r\n            switch (_f.label) {\r\n                case 0:\r\n                    _f.trys.push([0, 5, 6, 7]);\r\n                    _b = __values(this.entries()), _c = _b.next();\r\n                    _f.label = 1;\r\n                case 1:\r\n                    if (!!_c.done) return [3 /*break*/, 4];\r\n                    _d = __read(_c.value, 2), value = _d[1];\r\n                    return [4 /*yield*/, value];\r\n                case 2:\r\n                    _f.sent();\r\n                    _f.label = 3;\r\n                case 3:\r\n                    _c = _b.next();\r\n                    return [3 /*break*/, 1];\r\n                case 4: return [3 /*break*/, 7];\r\n                case 5:\r\n                    e_2_1 = _f.sent();\r\n                    e_2 = { error: e_2_1 };\r\n                    return [3 /*break*/, 7];\r\n                case 6:\r\n                    try {\r\n                        if (_c && !_c.done && (_e = _b.return)) _e.call(_b);\r\n                    }\r\n                    finally { if (e_2) throw e_2.error; }\r\n                    return [7 /*endfinally*/];\r\n                case 7: return [2 /*return*/];\r\n            }\r\n        });\r\n    };\r\n    MichelsonMap.prototype.entries = function () {\r\n        var _b, _c, key, e_3_1;\r\n        var e_3, _d;\r\n        return __generator(this, function (_e) {\r\n            switch (_e.label) {\r\n                case 0:\r\n                    _e.trys.push([0, 5, 6, 7]);\r\n                    _b = __values(this.valueMap.keys()), _c = _b.next();\r\n                    _e.label = 1;\r\n                case 1:\r\n                    if (!!_c.done) return [3 /*break*/, 4];\r\n                    key = _c.value;\r\n                    return [4 /*yield*/, [this.keyMap.get(key), this.valueMap.get(key)]];\r\n                case 2:\r\n                    _e.sent();\r\n                    _e.label = 3;\r\n                case 3:\r\n                    _c = _b.next();\r\n                    return [3 /*break*/, 1];\r\n                case 4: return [3 /*break*/, 7];\r\n                case 5:\r\n                    e_3_1 = _e.sent();\r\n                    e_3 = { error: e_3_1 };\r\n                    return [3 /*break*/, 7];\r\n                case 6:\r\n                    try {\r\n                        if (_c && !_c.done && (_d = _b.return)) _d.call(_b);\r\n                    }\r\n                    finally { if (e_3) throw e_3.error; }\r\n                    return [7 /*endfinally*/];\r\n                case 7: return [2 /*return*/];\r\n            }\r\n        });\r\n    };\r\n    MichelsonMap.prototype.get = function (key) {\r\n        this.assertTypecheckKey(key);\r\n        var strKey = this.serializeDeterministically(key);\r\n        return this.valueMap.get(strKey);\r\n    };\r\n    /**\r\n     *\r\n     * @description Set a key and a value in the MichelsonMap. If the key already exists, override the current value.\r\n     *\r\n     * @example map.set(\"myKey\", \"myValue\") // Using a string as key\r\n     *\r\n     * @example map.set({0: \"test\", 1: \"test1\"}, \"myValue\") // Using a pair as key\r\n     *\r\n     * @warn The same key can be represented in multiple ways, depending on the type of the key. This duplicate key situation will cause a runtime error (duplicate key) when sending the map data to the Tezos RPC node.\r\n     *\r\n     * For example, consider a contract with a map whose key is of type boolean.  If you set the following values in MichelsonMap: map.set(false, \"myValue\") and map.set(null, \"myValue\").\r\n     *\r\n     * You will get two unique entries in the MichelsonMap. These values will both be evaluated as falsy by the MichelsonEncoder and ultimately rejected by the Tezos RPC.\r\n     */\r\n    MichelsonMap.prototype.set = function (key, value) {\r\n        this.assertTypecheckKey(key);\r\n        this.assertTypecheckValue(value);\r\n        var strKey = this.serializeDeterministically(key);\r\n        this.keyMap.set(strKey, key);\r\n        this.valueMap.set(strKey, value);\r\n    };\r\n    MichelsonMap.prototype.delete = function (key) {\r\n        this.assertTypecheckKey(key);\r\n        this.keyMap.delete(this.serializeDeterministically(key));\r\n        this.valueMap.delete(this.serializeDeterministically(key));\r\n    };\r\n    MichelsonMap.prototype.has = function (key) {\r\n        this.assertTypecheckKey(key);\r\n        var strKey = this.serializeDeterministically(key);\r\n        return this.keyMap.has(strKey) && this.valueMap.has(strKey);\r\n    };\r\n    MichelsonMap.prototype.clear = function () {\r\n        this.keyMap.clear();\r\n        this.valueMap.clear();\r\n    };\r\n    Object.defineProperty(MichelsonMap.prototype, \"size\", {\r\n        get: function () {\r\n            return this.keyMap.size;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    MichelsonMap.prototype.forEach = function (cb) {\r\n        var e_4, _b;\r\n        try {\r\n            for (var _c = __values(this.entries()), _d = _c.next(); !_d.done; _d = _c.next()) {\r\n                var _e = __read(_d.value, 2), key = _e[0], value = _e[1];\r\n                cb(value, key, this);\r\n            }\r\n        }\r\n        catch (e_4_1) { e_4 = { error: e_4_1 }; }\r\n        finally {\r\n            try {\r\n                if (_d && !_d.done && (_b = _c.return)) _b.call(_c);\r\n            }\r\n            finally { if (e_4) throw e_4.error; }\r\n        }\r\n    };\r\n    return MichelsonMap;\r\n}());\r\n_a = michelsonMapTypeSymbol;\n\nvar TokenValidationError = /** @class */ (function () {\r\n    function TokenValidationError(value, token, baseMessage) {\r\n        this.value = value;\r\n        this.token = token;\r\n        this.name = 'ValidationError';\r\n        var annot = this.token.annot();\r\n        var annotText = annot ? \"[\" + annot + \"] \" : '';\r\n        this.message = \"\" + annotText + baseMessage;\r\n    }\r\n    return TokenValidationError;\r\n}());\r\nvar Token = /** @class */ (function () {\r\n    function Token(val, idx, fac) {\r\n        this.val = val;\r\n        this.idx = idx;\r\n        this.fac = fac;\r\n        this.createToken = this.fac;\r\n    }\r\n    Token.prototype.typeWithoutAnnotations = function () {\r\n        var removeArgsRec = function (val) {\r\n            if (val.args) {\r\n                return {\r\n                    prim: val.prim,\r\n                    args: val.args.map(function (x) { return removeArgsRec(x); }),\r\n                };\r\n            }\r\n            else {\r\n                return {\r\n                    prim: val.prim,\r\n                };\r\n            }\r\n        };\r\n        return removeArgsRec(this.val);\r\n    };\r\n    Token.prototype.annot = function () {\r\n        return (Array.isArray(this.val.annots) && this.val.annots.length > 0\r\n            ? this.val.annots[0]\r\n            : String(this.idx)).replace(/(%|\\:)(_Liq_entry_)?/, '');\r\n    };\r\n    Token.prototype.hasAnnotations = function () {\r\n        return Array.isArray(this.val.annots) && this.val.annots.length;\r\n    };\r\n    Token.prototype.ExtractSignature = function () {\r\n        return [[this.ExtractSchema()]];\r\n    };\r\n    return Token;\r\n}());\r\nvar ComparableToken = /** @class */ (function (_super) {\r\n    __extends(ComparableToken, _super);\r\n    function ComparableToken() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    ComparableToken.prototype.compare = function (o1, o2) {\r\n        if (o1 === o2) {\r\n            return 0;\r\n        }\r\n        return o1 < o2 ? -1 : 1;\r\n    };\r\n    return ComparableToken;\r\n}(Token));\n\nvar BigMapValidationError = /** @class */ (function (_super) {\r\n    __extends(BigMapValidationError, _super);\r\n    function BigMapValidationError(value, token, message) {\r\n        var _this = _super.call(this, value, token, message) || this;\r\n        _this.value = value;\r\n        _this.token = token;\r\n        _this.name = 'BigMapValidationError';\r\n        return _this;\r\n    }\r\n    return BigMapValidationError;\r\n}(TokenValidationError));\r\nvar BigMapToken = /** @class */ (function (_super) {\r\n    __extends(BigMapToken, _super);\r\n    function BigMapToken(val, idx, fac) {\r\n        var _this = _super.call(this, val, idx, fac) || this;\r\n        _this.val = val;\r\n        _this.idx = idx;\r\n        _this.fac = fac;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(BigMapToken.prototype, \"ValueSchema\", {\r\n        get: function () {\r\n            return this.createToken(this.val.args[1], 0);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(BigMapToken.prototype, \"KeySchema\", {\r\n        get: function () {\r\n            return this.createToken(this.val.args[0], 0);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    BigMapToken.prototype.ExtractSchema = function () {\r\n        var _a;\r\n        return _a = {},\r\n            _a[this.KeySchema.ExtractSchema()] = this.ValueSchema.ExtractSchema(),\r\n            _a;\r\n    };\r\n    BigMapToken.prototype.isValid = function (value) {\r\n        if (MichelsonMap.isMichelsonMap(value)) {\r\n            return null;\r\n        }\r\n        return new BigMapValidationError(value, this, 'Value must be a MichelsonMap');\r\n    };\r\n    BigMapToken.prototype.Encode = function (args) {\r\n        var _this = this;\r\n        var val = args.pop();\r\n        var err = this.isValid(val);\r\n        if (err) {\r\n            throw err;\r\n        }\r\n        return Array.from(val.keys())\r\n            .sort(function (a, b) { return _this.KeySchema.compare(a, b); })\r\n            .map(function (key) {\r\n            return {\r\n                prim: 'Elt',\r\n                args: [_this.KeySchema.EncodeObject(key), _this.ValueSchema.EncodeObject(val.get(key))],\r\n            };\r\n        });\r\n    };\r\n    BigMapToken.prototype.EncodeObject = function (args) {\r\n        var _this = this;\r\n        var val = args;\r\n        var err = this.isValid(val);\r\n        if (err) {\r\n            throw err;\r\n        }\r\n        return Array.from(val.keys())\r\n            .sort(function (a, b) { return _this.KeySchema.compare(a, b); })\r\n            .map(function (key) {\r\n            return {\r\n                prim: 'Elt',\r\n                args: [_this.KeySchema.EncodeObject(key), _this.ValueSchema.EncodeObject(val.get(key))],\r\n            };\r\n        });\r\n    };\r\n    BigMapToken.prototype.Execute = function (val, semantic) {\r\n        var _this = this;\r\n        if (semantic && semantic[BigMapToken.prim]) {\r\n            return semantic[BigMapToken.prim](val, this.val);\r\n        }\r\n        if (Array.isArray(val)) {\r\n            // Athens is returning an empty array for big map in storage\r\n            // Internal: In taquito v5 it is still used to decode big map diff (as if they were a regular map)\r\n            var map_1 = new MichelsonMap(this.val);\r\n            val.forEach(function (current) {\r\n                map_1.set(_this.KeySchema.ToKey(current.args[0]), _this.ValueSchema.Execute(current.args[1]));\r\n            });\r\n            return map_1;\r\n        }\r\n        else if ('int' in val) {\r\n            // Babylon is returning an int with the big map id in contract storage\r\n            return val.int;\r\n        }\r\n        else {\r\n            // Unknown case\r\n            throw new Error(\"Big map is expecting either an array (Athens) or an object with an int property (Babylon). Got \" + JSON.stringify(val));\r\n        }\r\n    };\r\n    BigMapToken.prim = 'big_map';\r\n    return BigMapToken;\r\n}(Token));\n\nvar OrToken = /** @class */ (function (_super) {\r\n    __extends(OrToken, _super);\r\n    function OrToken(val, idx, fac) {\r\n        var _this = _super.call(this, val, idx, fac) || this;\r\n        _this.val = val;\r\n        _this.idx = idx;\r\n        _this.fac = fac;\r\n        return _this;\r\n    }\r\n    OrToken.prototype.Encode = function (args) {\r\n        var label = args[args.length - 1];\r\n        var leftToken = this.createToken(this.val.args[0], this.idx);\r\n        var keyCount = 1;\r\n        if (leftToken instanceof OrToken) {\r\n            keyCount = Object.keys(leftToken.ExtractSchema()).length;\r\n        }\r\n        var rightToken = this.createToken(this.val.args[1], this.idx + keyCount);\r\n        if (String(leftToken.annot()) === String(label) && !(leftToken instanceof OrToken)) {\r\n            args.pop();\r\n            return { prim: 'Left', args: [leftToken.Encode(args)] };\r\n        }\r\n        else if (String(rightToken.annot()) === String(label) && !(rightToken instanceof OrToken)) {\r\n            args.pop();\r\n            return { prim: 'Right', args: [rightToken.Encode(args)] };\r\n        }\r\n        else {\r\n            if (leftToken instanceof OrToken) {\r\n                var val = leftToken.Encode(args);\r\n                if (val) {\r\n                    return { prim: 'Left', args: [val] };\r\n                }\r\n            }\r\n            if (rightToken instanceof OrToken) {\r\n                var val = rightToken.Encode(args);\r\n                if (val) {\r\n                    return { prim: 'Right', args: [val] };\r\n                }\r\n            }\r\n            return null;\r\n        }\r\n    };\r\n    OrToken.prototype.ExtractSignature = function () {\r\n        var e_1, _a, e_2, _b;\r\n        var leftToken = this.createToken(this.val.args[0], this.idx);\r\n        var keyCount = 1;\r\n        if (leftToken instanceof OrToken) {\r\n            keyCount = Object.keys(leftToken.ExtractSchema()).length;\r\n        }\r\n        var rightToken = this.createToken(this.val.args[1], this.idx + keyCount);\r\n        var newSig = [];\r\n        if (leftToken instanceof OrToken) {\r\n            newSig.push.apply(newSig, __spread(leftToken.ExtractSignature()));\r\n        }\r\n        else {\r\n            try {\r\n                for (var _c = __values(leftToken.ExtractSignature()), _d = _c.next(); !_d.done; _d = _c.next()) {\r\n                    var sig = _d.value;\r\n                    newSig.push(__spread([leftToken.annot()], sig));\r\n                }\r\n            }\r\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\r\n            finally {\r\n                try {\r\n                    if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\r\n                }\r\n                finally { if (e_1) throw e_1.error; }\r\n            }\r\n        }\r\n        if (rightToken instanceof OrToken) {\r\n            newSig.push.apply(newSig, __spread(rightToken.ExtractSignature()));\r\n        }\r\n        else {\r\n            try {\r\n                for (var _e = __values(rightToken.ExtractSignature()), _f = _e.next(); !_f.done; _f = _e.next()) {\r\n                    var sig = _f.value;\r\n                    newSig.push(__spread([rightToken.annot()], sig));\r\n                }\r\n            }\r\n            catch (e_2_1) { e_2 = { error: e_2_1 }; }\r\n            finally {\r\n                try {\r\n                    if (_f && !_f.done && (_b = _e.return)) _b.call(_e);\r\n                }\r\n                finally { if (e_2) throw e_2.error; }\r\n            }\r\n        }\r\n        return newSig;\r\n    };\r\n    OrToken.prototype.EncodeObject = function (args) {\r\n        var label = Object.keys(args)[0];\r\n        var leftToken = this.createToken(this.val.args[0], this.idx);\r\n        var keyCount = 1;\r\n        if (leftToken instanceof OrToken) {\r\n            keyCount = Object.keys(leftToken.ExtractSchema()).length;\r\n        }\r\n        var rightToken = this.createToken(this.val.args[1], this.idx + keyCount);\r\n        if (String(leftToken.annot()) === String(label) && !(leftToken instanceof OrToken)) {\r\n            return { prim: 'Left', args: [leftToken.EncodeObject(args[label])] };\r\n        }\r\n        else if (String(rightToken.annot()) === String(label) && !(rightToken instanceof OrToken)) {\r\n            return { prim: 'Right', args: [rightToken.EncodeObject(args[label])] };\r\n        }\r\n        else {\r\n            if (leftToken instanceof OrToken) {\r\n                var val = leftToken.EncodeObject(args);\r\n                if (val) {\r\n                    return { prim: 'Left', args: [val] };\r\n                }\r\n            }\r\n            if (rightToken instanceof OrToken) {\r\n                var val = rightToken.EncodeObject(args);\r\n                if (val) {\r\n                    return { prim: 'Right', args: [val] };\r\n                }\r\n            }\r\n            return null;\r\n        }\r\n    };\r\n    OrToken.prototype.Execute = function (val, semantics) {\r\n        var _a;\r\n        var leftToken = this.createToken(this.val.args[0], this.idx);\r\n        var keyCount = 1;\r\n        if (leftToken instanceof OrToken) {\r\n            keyCount = Object.keys(leftToken.ExtractSchema()).length;\r\n        }\r\n        var rightToken = this.createToken(this.val.args[1], this.idx + keyCount);\r\n        if (val.prim === 'Right') {\r\n            return rightToken.Execute(val.args[0], semantics);\r\n        }\r\n        else if (val.prim === 'Left') {\r\n            return _a = {},\r\n                _a[leftToken.annot()] = leftToken.Execute(val.args[0], semantics),\r\n                _a;\r\n        }\r\n        else {\r\n            throw new Error(\"Was expecting Left or Right prim but got: \" + val.prim);\r\n        }\r\n    };\r\n    OrToken.prototype.traversal = function (getLeftValue, getRightValue, concat) {\r\n        var _a, _b;\r\n        var leftToken = this.createToken(this.val.args[0], this.idx);\r\n        var keyCount = 1;\r\n        var leftValue;\r\n        if (leftToken instanceof OrToken && !leftToken.hasAnnotations()) {\r\n            leftValue = getLeftValue(leftToken);\r\n            keyCount = Object.keys(leftToken.ExtractSchema()).length;\r\n        }\r\n        else {\r\n            leftValue = (_a = {}, _a[leftToken.annot()] = getLeftValue(leftToken), _a);\r\n        }\r\n        var rightToken = this.createToken(this.val.args[1], this.idx + keyCount);\r\n        var rightValue;\r\n        if (rightToken instanceof OrToken && !rightToken.hasAnnotations()) {\r\n            rightValue = getRightValue(rightToken);\r\n        }\r\n        else {\r\n            rightValue = (_b = {}, _b[rightToken.annot()] = getRightValue(rightToken), _b);\r\n        }\r\n        var res = concat(leftValue, rightValue);\r\n        return res;\r\n    };\r\n    OrToken.prototype.ExtractSchema = function () {\r\n        return this.traversal(function (leftToken) { return leftToken.ExtractSchema(); }, function (rightToken) { return rightToken.ExtractSchema(); }, function (leftValue, rightValue) { return (__assign(__assign({}, leftValue), rightValue)); });\r\n    };\r\n    OrToken.prim = 'or';\r\n    return OrToken;\r\n}(Token));\n\nvar PairToken = /** @class */ (function (_super) {\r\n    __extends(PairToken, _super);\r\n    function PairToken(val, idx, fac) {\r\n        var _this = _super.call(this, val, idx, fac) || this;\r\n        _this.val = val;\r\n        _this.idx = idx;\r\n        _this.fac = fac;\r\n        return _this;\r\n    }\r\n    PairToken.prototype.Encode = function (args) {\r\n        var leftToken = this.createToken(this.val.args[0], this.idx);\r\n        var keyCount = 1;\r\n        if (leftToken instanceof PairToken) {\r\n            keyCount = Object.keys(leftToken.ExtractSchema()).length;\r\n        }\r\n        var rightToken = this.createToken(this.val.args[1], this.idx + keyCount);\r\n        return {\r\n            prim: 'Pair',\r\n            args: [leftToken.Encode(args), rightToken.Encode(args)],\r\n        };\r\n    };\r\n    PairToken.prototype.ExtractSignature = function () {\r\n        var e_1, _a, e_2, _b;\r\n        var leftToken = this.createToken(this.val.args[0], this.idx);\r\n        var keyCount = 1;\r\n        if (leftToken instanceof OrToken) {\r\n            keyCount = Object.keys(leftToken.ExtractSchema()).length;\r\n        }\r\n        var rightToken = this.createToken(this.val.args[1], this.idx + keyCount);\r\n        var newSig = [];\r\n        try {\r\n            for (var _c = __values(leftToken.ExtractSignature()), _d = _c.next(); !_d.done; _d = _c.next()) {\r\n                var leftSig = _d.value;\r\n                try {\r\n                    for (var _e = (e_2 = void 0, __values(rightToken.ExtractSignature())), _f = _e.next(); !_f.done; _f = _e.next()) {\r\n                        var rightSig = _f.value;\r\n                        newSig.push(__spread(leftSig, rightSig));\r\n                    }\r\n                }\r\n                catch (e_2_1) { e_2 = { error: e_2_1 }; }\r\n                finally {\r\n                    try {\r\n                        if (_f && !_f.done && (_b = _e.return)) _b.call(_e);\r\n                    }\r\n                    finally { if (e_2) throw e_2.error; }\r\n                }\r\n            }\r\n        }\r\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\r\n        finally {\r\n            try {\r\n                if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\r\n            }\r\n            finally { if (e_1) throw e_1.error; }\r\n        }\r\n        return newSig;\r\n    };\r\n    PairToken.prototype.ToBigMapKey = function (val) {\r\n        return {\r\n            key: this.EncodeObject(val),\r\n            type: this.typeWithoutAnnotations(),\r\n        };\r\n    };\r\n    PairToken.prototype.ToKey = function (val) {\r\n        return this.Execute(val);\r\n    };\r\n    PairToken.prototype.EncodeObject = function (args) {\r\n        var leftToken = this.createToken(this.val.args[0], this.idx);\r\n        var keyCount = 1;\r\n        if (leftToken instanceof PairToken) {\r\n            keyCount = Object.keys(leftToken.ExtractSchema()).length;\r\n        }\r\n        var rightToken = this.createToken(this.val.args[1], this.idx + keyCount);\r\n        var leftValue;\r\n        if (leftToken instanceof PairToken && !leftToken.hasAnnotations()) {\r\n            leftValue = args;\r\n        }\r\n        else {\r\n            leftValue = args[leftToken.annot()];\r\n        }\r\n        var rightValue;\r\n        if (rightToken instanceof PairToken && !rightToken.hasAnnotations()) {\r\n            rightValue = args;\r\n        }\r\n        else {\r\n            rightValue = args[rightToken.annot()];\r\n        }\r\n        return {\r\n            prim: 'Pair',\r\n            args: [leftToken.EncodeObject(leftValue), rightToken.EncodeObject(rightValue)],\r\n        };\r\n    };\r\n    PairToken.prototype.traversal = function (getLeftValue, getRightValue) {\r\n        var _a, _b;\r\n        var leftToken = this.createToken(this.val.args[0], this.idx);\r\n        var keyCount = 1;\r\n        var leftValue;\r\n        if (leftToken instanceof PairToken && !leftToken.hasAnnotations()) {\r\n            leftValue = getLeftValue(leftToken);\r\n            keyCount = Object.keys(leftToken.ExtractSchema()).length;\r\n        }\r\n        else {\r\n            leftValue = (_a = {}, _a[leftToken.annot()] = getLeftValue(leftToken), _a);\r\n        }\r\n        var rightToken = this.createToken(this.val.args[1], this.idx + keyCount);\r\n        var rightValue;\r\n        if (rightToken instanceof PairToken && !rightToken.hasAnnotations()) {\r\n            rightValue = getRightValue(rightToken);\r\n        }\r\n        else {\r\n            rightValue = (_b = {}, _b[rightToken.annot()] = getRightValue(rightToken), _b);\r\n        }\r\n        var res = __assign(__assign({}, leftValue), rightValue);\r\n        return res;\r\n    };\r\n    PairToken.prototype.Execute = function (val, semantics) {\r\n        return this.traversal(function (leftToken) { return leftToken.Execute(val.args[0], semantics); }, function (rightToken) { return rightToken.Execute(val.args[1], semantics); });\r\n    };\r\n    PairToken.prototype.ExtractSchema = function () {\r\n        return this.traversal(function (leftToken) { return leftToken.ExtractSchema(); }, function (rightToken) { return rightToken.ExtractSchema(); });\r\n    };\r\n    PairToken.prototype.compare = function (val1, val2) {\r\n        var leftToken = this.createToken(this.val.args[0], this.idx);\r\n        var keyCount = 1;\r\n        if (leftToken instanceof PairToken) {\r\n            keyCount = Object.keys(leftToken.ExtractSchema()).length;\r\n        }\r\n        var rightToken = this.createToken(this.val.args[1], this.idx + keyCount);\r\n        var getValue = function (token, args) {\r\n            if (token instanceof PairToken && !token.hasAnnotations()) {\r\n                return args;\r\n            }\r\n            else {\r\n                return args[token.annot()];\r\n            }\r\n        };\r\n        if (leftToken instanceof ComparableToken && rightToken instanceof ComparableToken) {\r\n            var result = leftToken.compare(getValue(leftToken, val1), getValue(leftToken, val2));\r\n            if (result === 0) {\r\n                return rightToken.compare(getValue(rightToken, val1), getValue(rightToken, val2));\r\n            }\r\n            return result;\r\n        }\r\n        throw new Error('Not a comparable pair');\r\n    };\r\n    PairToken.prim = 'pair';\r\n    return PairToken;\r\n}(ComparableToken));\n\nvar NatValidationError = /** @class */ (function (_super) {\r\n    __extends(NatValidationError, _super);\r\n    function NatValidationError(value, token, message) {\r\n        var _this = _super.call(this, value, token, message) || this;\r\n        _this.value = value;\r\n        _this.token = token;\r\n        _this.name = 'NatValidationError';\r\n        return _this;\r\n    }\r\n    return NatValidationError;\r\n}(TokenValidationError));\r\nvar NatToken = /** @class */ (function (_super) {\r\n    __extends(NatToken, _super);\r\n    function NatToken(val, idx, fac) {\r\n        var _this = _super.call(this, val, idx, fac) || this;\r\n        _this.val = val;\r\n        _this.idx = idx;\r\n        _this.fac = fac;\r\n        return _this;\r\n    }\r\n    NatToken.prototype.Execute = function (val) {\r\n        return new BigNumber(val[Object.keys(val)[0]]);\r\n    };\r\n    NatToken.prototype.Encode = function (args) {\r\n        var val = args.pop();\r\n        var err = this.isValid(val);\r\n        if (err) {\r\n            throw err;\r\n        }\r\n        return { int: String(val).toString() };\r\n    };\r\n    NatToken.prototype.isValid = function (val) {\r\n        var bigNumber = new BigNumber(val);\r\n        if (bigNumber.isNaN()) {\r\n            return new NatValidationError(val, this, \"Value is not a number: \" + val);\r\n        }\r\n        else if (bigNumber.isNegative()) {\r\n            return new NatValidationError(val, this, \"Value cannot be negative: \" + val);\r\n        }\r\n        else {\r\n            return null;\r\n        }\r\n    };\r\n    NatToken.prototype.EncodeObject = function (val) {\r\n        var err = this.isValid(val);\r\n        if (err) {\r\n            throw err;\r\n        }\r\n        return { int: String(val).toString() };\r\n    };\r\n    NatToken.prototype.ExtractSchema = function () {\r\n        return NatToken.prim;\r\n    };\r\n    NatToken.prototype.ToBigMapKey = function (val) {\r\n        return {\r\n            key: { int: val },\r\n            type: { prim: NatToken.prim },\r\n        };\r\n    };\r\n    NatToken.prototype.ToKey = function (_a) {\r\n        var int = _a.int;\r\n        return int;\r\n    };\r\n    NatToken.prim = 'nat';\r\n    return NatToken;\r\n}(ComparableToken));\n\nvar StringToken = /** @class */ (function (_super) {\r\n    __extends(StringToken, _super);\r\n    function StringToken(val, idx, fac) {\r\n        var _this = _super.call(this, val, idx, fac) || this;\r\n        _this.val = val;\r\n        _this.idx = idx;\r\n        _this.fac = fac;\r\n        return _this;\r\n    }\r\n    StringToken.prototype.Execute = function (val) {\r\n        return val[Object.keys(val)[0]];\r\n    };\r\n    StringToken.prototype.ExtractSchema = function () {\r\n        return StringToken.prim;\r\n    };\r\n    StringToken.prototype.Encode = function (args) {\r\n        var val = args.pop();\r\n        return { string: val };\r\n    };\r\n    StringToken.prototype.EncodeObject = function (val) {\r\n        return { string: val };\r\n    };\r\n    // tslint:disable-next-line: variable-name\r\n    StringToken.prototype.ToKey = function (_a) {\r\n        var string = _a.string;\r\n        return string;\r\n    };\r\n    StringToken.prototype.ToBigMapKey = function (val) {\r\n        return {\r\n            key: { string: val },\r\n            type: { prim: StringToken.prim },\r\n        };\r\n    };\r\n    StringToken.prim = 'string';\r\n    return StringToken;\r\n}(ComparableToken));\n\nvar AddressValidationError = /** @class */ (function (_super) {\r\n    __extends(AddressValidationError, _super);\r\n    function AddressValidationError(value, token, message) {\r\n        var _this = _super.call(this, value, token, message) || this;\r\n        _this.value = value;\r\n        _this.token = token;\r\n        _this.name = 'AddressValidationError';\r\n        return _this;\r\n    }\r\n    return AddressValidationError;\r\n}(TokenValidationError));\r\nvar AddressToken = /** @class */ (function (_super) {\r\n    __extends(AddressToken, _super);\r\n    function AddressToken(val, idx, fac) {\r\n        var _this = _super.call(this, val, idx, fac) || this;\r\n        _this.val = val;\r\n        _this.idx = idx;\r\n        _this.fac = fac;\r\n        return _this;\r\n    }\r\n    AddressToken.prototype.ToBigMapKey = function (val) {\r\n        var decoded = b58decode(val);\r\n        return {\r\n            key: { bytes: decoded },\r\n            type: { prim: 'bytes' },\r\n        };\r\n    };\r\n    AddressToken.prototype.isValid = function (value) {\r\n        if (validateAddress(value) !== ValidationResult.VALID) {\r\n            return new AddressValidationError(value, this, \"Address is not valid: \" + value);\r\n        }\r\n        return null;\r\n    };\r\n    AddressToken.prototype.Encode = function (args) {\r\n        var val = args.pop();\r\n        var err = this.isValid(val);\r\n        if (err) {\r\n            throw err;\r\n        }\r\n        return { string: val };\r\n    };\r\n    AddressToken.prototype.EncodeObject = function (val) {\r\n        var err = this.isValid(val);\r\n        if (err) {\r\n            throw err;\r\n        }\r\n        return { string: val };\r\n    };\r\n    // tslint:disable-next-line: variable-name\r\n    AddressToken.prototype.Execute = function (val) {\r\n        if (val.string) {\r\n            return val.string;\r\n        }\r\n        return encodePubKey(val.bytes);\r\n    };\r\n    AddressToken.prototype.ExtractSchema = function () {\r\n        return AddressToken.prim;\r\n    };\r\n    // tslint:disable-next-line: variable-name\r\n    AddressToken.prototype.ToKey = function (_a) {\r\n        var bytes = _a.bytes, string = _a.string;\r\n        if (string) {\r\n            return string;\r\n        }\r\n        return encodePubKey(bytes);\r\n    };\r\n    AddressToken.prototype.compare = function (address1, address2) {\r\n        var isImplicit = function (address) {\r\n            return address.startsWith('tz');\r\n        };\r\n        if (isImplicit(address1) && isImplicit(address2)) {\r\n            return _super.prototype.compare.call(this, address1, address2);\r\n        }\r\n        else if (isImplicit(address1)) {\r\n            return -1;\r\n        }\r\n        else if (isImplicit(address2)) {\r\n            return 1;\r\n        }\r\n        else {\r\n            return _super.prototype.compare.call(this, address1, address2);\r\n        }\r\n    };\r\n    AddressToken.prim = 'address';\r\n    return AddressToken;\r\n}(ComparableToken));\n\nvar MapValidationError = /** @class */ (function (_super) {\r\n    __extends(MapValidationError, _super);\r\n    function MapValidationError(value, token, message) {\r\n        var _this = _super.call(this, value, token, message) || this;\r\n        _this.value = value;\r\n        _this.token = token;\r\n        _this.name = 'MapValidationError';\r\n        return _this;\r\n    }\r\n    return MapValidationError;\r\n}(TokenValidationError));\r\nvar MapToken = /** @class */ (function (_super) {\r\n    __extends(MapToken, _super);\r\n    function MapToken(val, idx, fac) {\r\n        var _this = _super.call(this, val, idx, fac) || this;\r\n        _this.val = val;\r\n        _this.idx = idx;\r\n        _this.fac = fac;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(MapToken.prototype, \"ValueSchema\", {\r\n        get: function () {\r\n            return this.createToken(this.val.args[1], 0);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MapToken.prototype, \"KeySchema\", {\r\n        get: function () {\r\n            return this.createToken(this.val.args[0], 0);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    MapToken.prototype.isValid = function (value) {\r\n        if (MichelsonMap.isMichelsonMap(value)) {\r\n            return null;\r\n        }\r\n        return new MapValidationError(value, this, 'Value must be a MichelsonMap');\r\n    };\r\n    MapToken.prototype.Execute = function (val, semantics) {\r\n        var _this = this;\r\n        var map = new MichelsonMap(this.val);\r\n        val.forEach(function (current) {\r\n            map.set(_this.KeySchema.ToKey(current.args[0]), _this.ValueSchema.Execute(current.args[1], semantics));\r\n        });\r\n        return map;\r\n    };\r\n    MapToken.prototype.Encode = function (args) {\r\n        var _this = this;\r\n        var val = args.pop();\r\n        var err = this.isValid(val);\r\n        if (err) {\r\n            throw err;\r\n        }\r\n        return Array.from(val.keys())\r\n            .sort(function (a, b) { return _this.KeySchema.compare(a, b); })\r\n            .map(function (key) {\r\n            return {\r\n                prim: 'Elt',\r\n                args: [_this.KeySchema.EncodeObject(key), _this.ValueSchema.EncodeObject(val.get(key))],\r\n            };\r\n        });\r\n    };\r\n    MapToken.prototype.EncodeObject = function (args) {\r\n        var _this = this;\r\n        var val = args;\r\n        var err = this.isValid(val);\r\n        if (err) {\r\n            throw err;\r\n        }\r\n        return Array.from(val.keys())\r\n            .sort(function (a, b) { return _this.KeySchema.compare(a, b); })\r\n            .map(function (key) {\r\n            return {\r\n                prim: 'Elt',\r\n                args: [_this.KeySchema.EncodeObject(key), _this.ValueSchema.EncodeObject(val.get(key))],\r\n            };\r\n        });\r\n    };\r\n    MapToken.prototype.ExtractSchema = function () {\r\n        return {\r\n            map: {\r\n                key: this.KeySchema.ExtractSchema(),\r\n                value: this.ValueSchema.ExtractSchema(),\r\n            },\r\n        };\r\n    };\r\n    MapToken.prim = 'map';\r\n    return MapToken;\r\n}(Token));\n\nvar BoolToken = /** @class */ (function (_super) {\r\n    __extends(BoolToken, _super);\r\n    function BoolToken(val, idx, fac) {\r\n        var _this = _super.call(this, val, idx, fac) || this;\r\n        _this.val = val;\r\n        _this.idx = idx;\r\n        _this.fac = fac;\r\n        return _this;\r\n    }\r\n    BoolToken.prototype.Execute = function (val) {\r\n        return String(val.prim).toLowerCase() === 'true' ? true : false;\r\n    };\r\n    BoolToken.prototype.Encode = function (args) {\r\n        var val = args.pop();\r\n        return { prim: val ? 'True' : 'False' };\r\n    };\r\n    BoolToken.prototype.EncodeObject = function (val) {\r\n        return { prim: val ? 'True' : 'False' };\r\n    };\r\n    BoolToken.prototype.ExtractSchema = function () {\r\n        return BoolToken.prim;\r\n    };\r\n    BoolToken.prototype.ToBigMapKey = function (val) {\r\n        return {\r\n            key: this.EncodeObject(val),\r\n            type: { prim: BoolToken.prim },\r\n        };\r\n    };\r\n    BoolToken.prototype.ToKey = function (val) {\r\n        return this.EncodeObject(val);\r\n    };\r\n    BoolToken.prototype.compare = function (val1, val2) {\r\n        if ((val1 && val2) || (!val1 && !val2)) {\r\n            return 0;\r\n        }\r\n        else if (val1) {\r\n            return 1;\r\n        }\r\n        else {\r\n            return -1;\r\n        }\r\n    };\r\n    BoolToken.prim = 'bool';\r\n    return BoolToken;\r\n}(ComparableToken));\n\nvar ContractValidationError = /** @class */ (function (_super) {\r\n    __extends(ContractValidationError, _super);\r\n    function ContractValidationError(value, token, message) {\r\n        var _this = _super.call(this, value, token, message) || this;\r\n        _this.value = value;\r\n        _this.token = token;\r\n        _this.name = 'ContractValidationError';\r\n        return _this;\r\n    }\r\n    return ContractValidationError;\r\n}(TokenValidationError));\r\nvar ContractToken = /** @class */ (function (_super) {\r\n    __extends(ContractToken, _super);\r\n    function ContractToken(val, idx, fac) {\r\n        var _this = _super.call(this, val, idx, fac) || this;\r\n        _this.val = val;\r\n        _this.idx = idx;\r\n        _this.fac = fac;\r\n        return _this;\r\n    }\r\n    ContractToken.prototype.isValid = function (value) {\r\n        // tz1,tz2 and tz3 seems to be valid contract values (for Unit contract)\r\n        if (validateAddress(value) !== ValidationResult.VALID) {\r\n            return new ContractValidationError(value, this, 'Contract address is not valid');\r\n        }\r\n        return null;\r\n    };\r\n    ContractToken.prototype.Execute = function (val) {\r\n        if (val.string) {\r\n            return val.string;\r\n        }\r\n        return encodePubKey(val.bytes);\r\n    };\r\n    ContractToken.prototype.Encode = function (args) {\r\n        var val = args.pop();\r\n        var err = this.isValid(val);\r\n        if (err) {\r\n            throw err;\r\n        }\r\n        return { string: val };\r\n    };\r\n    ContractToken.prototype.EncodeObject = function (val) {\r\n        var err = this.isValid(val);\r\n        if (err) {\r\n            throw err;\r\n        }\r\n        return { string: val };\r\n    };\r\n    ContractToken.prototype.ExtractSchema = function () {\r\n        return ContractToken.prim;\r\n    };\r\n    ContractToken.prim = 'contract';\r\n    return ContractToken;\r\n}(Token));\n\nvar ListValidationError = /** @class */ (function (_super) {\r\n    __extends(ListValidationError, _super);\r\n    function ListValidationError(value, token, message) {\r\n        var _this = _super.call(this, value, token, message) || this;\r\n        _this.value = value;\r\n        _this.token = token;\r\n        _this.name = 'ListValidationError';\r\n        return _this;\r\n    }\r\n    return ListValidationError;\r\n}(TokenValidationError));\r\nvar ListToken = /** @class */ (function (_super) {\r\n    __extends(ListToken, _super);\r\n    function ListToken(val, idx, fac) {\r\n        var _this = _super.call(this, val, idx, fac) || this;\r\n        _this.val = val;\r\n        _this.idx = idx;\r\n        _this.fac = fac;\r\n        return _this;\r\n    }\r\n    ListToken.prototype.isValid = function (value) {\r\n        if (Array.isArray(value)) {\r\n            return null;\r\n        }\r\n        return new ListValidationError(value, this, 'Value must be an array');\r\n    };\r\n    ListToken.prototype.Encode = function (args) {\r\n        var val = args.pop();\r\n        var err = this.isValid(val);\r\n        if (err) {\r\n            throw err;\r\n        }\r\n        var schema = this.createToken(this.val.args[0], 0);\r\n        return val.reduce(function (prev, current) {\r\n            return __spread(prev, [schema.EncodeObject(current)]);\r\n        }, []);\r\n    };\r\n    ListToken.prototype.Execute = function (val, semantics) {\r\n        var schema = this.createToken(this.val.args[0], 0);\r\n        var err = this.isValid(val);\r\n        if (err) {\r\n            throw err;\r\n        }\r\n        return val.reduce(function (prev, current) {\r\n            return __spread(prev, [schema.Execute(current, semantics)]);\r\n        }, []);\r\n    };\r\n    ListToken.prototype.EncodeObject = function (args) {\r\n        var schema = this.createToken(this.val.args[0], 0);\r\n        var err = this.isValid(args);\r\n        if (err) {\r\n            throw err;\r\n        }\r\n        return args.reduce(function (prev, current) {\r\n            return __spread(prev, [schema.EncodeObject(current)]);\r\n        }, []);\r\n    };\r\n    ListToken.prototype.ExtractSchema = function () {\r\n        return ListToken.prim;\r\n    };\r\n    ListToken.prim = 'list';\r\n    return ListToken;\r\n}(Token));\n\nvar MutezValidationError = /** @class */ (function (_super) {\r\n    __extends(MutezValidationError, _super);\r\n    function MutezValidationError(value, token, message) {\r\n        var _this = _super.call(this, value, token, message) || this;\r\n        _this.value = value;\r\n        _this.token = token;\r\n        _this.name = 'MutezValidationError';\r\n        return _this;\r\n    }\r\n    return MutezValidationError;\r\n}(TokenValidationError));\r\nvar MutezToken = /** @class */ (function (_super) {\r\n    __extends(MutezToken, _super);\r\n    function MutezToken(val, idx, fac) {\r\n        var _this = _super.call(this, val, idx, fac) || this;\r\n        _this.val = val;\r\n        _this.idx = idx;\r\n        _this.fac = fac;\r\n        return _this;\r\n    }\r\n    MutezToken.prototype.Execute = function (val) {\r\n        return new BigNumber(val[Object.keys(val)[0]]);\r\n    };\r\n    MutezToken.prototype.ExtractSchema = function () {\r\n        return MutezToken.prim;\r\n    };\r\n    MutezToken.prototype.isValid = function (val) {\r\n        var bigNumber = new BigNumber(val);\r\n        if (bigNumber.isNaN()) {\r\n            return new MutezValidationError(val, this, \"Value is not a number: \" + val);\r\n        }\r\n        else {\r\n            return null;\r\n        }\r\n    };\r\n    MutezToken.prototype.Encode = function (args) {\r\n        var val = args.pop();\r\n        var err = this.isValid(val);\r\n        if (err) {\r\n            throw err;\r\n        }\r\n        return { int: String(val).toString() };\r\n    };\r\n    MutezToken.prototype.EncodeObject = function (val) {\r\n        var err = this.isValid(val);\r\n        if (err) {\r\n            throw err;\r\n        }\r\n        return { int: String(val).toString() };\r\n    };\r\n    MutezToken.prototype.ToBigMapKey = function (val) {\r\n        return {\r\n            key: { int: val },\r\n            type: { prim: MutezToken.prim },\r\n        };\r\n    };\r\n    MutezToken.prototype.ToKey = function (_a) {\r\n        var int = _a.int;\r\n        return int;\r\n    };\r\n    MutezToken.prim = 'mutez';\r\n    return MutezToken;\r\n}(ComparableToken));\n\nvar BytesValidationError = /** @class */ (function (_super) {\r\n    __extends(BytesValidationError, _super);\r\n    function BytesValidationError(value, token, message) {\r\n        var _this = _super.call(this, value, token, message) || this;\r\n        _this.value = value;\r\n        _this.token = token;\r\n        _this.name = 'BytesValidationError';\r\n        return _this;\r\n    }\r\n    return BytesValidationError;\r\n}(TokenValidationError));\r\nvar BytesToken = /** @class */ (function (_super) {\r\n    __extends(BytesToken, _super);\r\n    function BytesToken(val, idx, fac) {\r\n        var _this = _super.call(this, val, idx, fac) || this;\r\n        _this.val = val;\r\n        _this.idx = idx;\r\n        _this.fac = fac;\r\n        return _this;\r\n    }\r\n    BytesToken.prototype.ToBigMapKey = function (val) {\r\n        return {\r\n            key: { bytes: val },\r\n            type: { prim: BytesToken.prim },\r\n        };\r\n    };\r\n    BytesToken.prototype.isValid = function (val) {\r\n        if (typeof val === 'string' && /^[0-9a-fA-F]*$/.test(val) && val.length % 2 === 0) {\r\n            return null;\r\n        }\r\n        else {\r\n            return new BytesValidationError(val, this, \"Invalid bytes: \" + val);\r\n        }\r\n    };\r\n    BytesToken.prototype.Encode = function (args) {\r\n        var val = args.pop();\r\n        var err = this.isValid(val);\r\n        if (err) {\r\n            throw err;\r\n        }\r\n        return { bytes: String(val).toString() };\r\n    };\r\n    BytesToken.prototype.EncodeObject = function (val) {\r\n        var err = this.isValid(val);\r\n        if (err) {\r\n            throw err;\r\n        }\r\n        return { bytes: String(val).toString() };\r\n    };\r\n    BytesToken.prototype.Execute = function (val) {\r\n        return val.bytes;\r\n    };\r\n    BytesToken.prototype.ExtractSchema = function () {\r\n        return BytesToken.prim;\r\n    };\r\n    // tslint:disable-next-line: variable-name\r\n    BytesToken.prototype.ToKey = function (_a) {\r\n        var bytes = _a.bytes, string = _a.string;\r\n        if (string) {\r\n            return string;\r\n        }\r\n        return bytes;\r\n    };\r\n    BytesToken.prim = 'bytes';\r\n    return BytesToken;\r\n}(ComparableToken));\n\nvar OptionToken = /** @class */ (function (_super) {\r\n    __extends(OptionToken, _super);\r\n    function OptionToken(val, idx, fac) {\r\n        var _this = _super.call(this, val, idx, fac) || this;\r\n        _this.val = val;\r\n        _this.idx = idx;\r\n        _this.fac = fac;\r\n        return _this;\r\n    }\r\n    OptionToken.prototype.subToken = function () {\r\n        return this.createToken(this.val.args[0], this.idx);\r\n    };\r\n    OptionToken.prototype.annot = function () {\r\n        return Array.isArray(this.val.annots)\r\n            ? _super.prototype.annot.call(this)\r\n            : this.createToken(this.val.args[0], this.idx).annot();\r\n    };\r\n    OptionToken.prototype.Encode = function (args) {\r\n        var value = args;\r\n        if (value === undefined ||\r\n            value === null) {\r\n            return { prim: 'None' };\r\n        }\r\n        else if ((Array.isArray(value) && (value[value.length - 1] === undefined || value[value.length - 1] === null))) {\r\n            value.pop();\r\n            return { prim: 'None' };\r\n        }\r\n        var schema = this.createToken(this.val.args[0], 0);\r\n        return { prim: 'Some', args: [schema.Encode(args)] };\r\n    };\r\n    OptionToken.prototype.EncodeObject = function (args) {\r\n        var schema = this.createToken(this.val.args[0], 0);\r\n        var value = args;\r\n        if (value === undefined || value === null) {\r\n            return { prim: 'None' };\r\n        }\r\n        return { prim: 'Some', args: [schema.EncodeObject(value)] };\r\n    };\r\n    OptionToken.prototype.Execute = function (val, semantics) {\r\n        if (val.prim === 'None') {\r\n            return null;\r\n        }\r\n        var schema = this.createToken(this.val.args[0], 0);\r\n        return schema.Execute(val.args[0], semantics);\r\n    };\r\n    OptionToken.prototype.ExtractSchema = function () {\r\n        var schema = this.createToken(this.val.args[0], 0);\r\n        return schema.ExtractSchema();\r\n    };\r\n    OptionToken.prototype.ExtractSignature = function () {\r\n        var schema = this.createToken(this.val.args[0], 0);\r\n        return __spread(schema.ExtractSignature(), [[]]);\r\n    };\r\n    OptionToken.prim = 'option';\r\n    return OptionToken;\r\n}(Token));\n\nvar TimestampToken = /** @class */ (function (_super) {\r\n    __extends(TimestampToken, _super);\r\n    function TimestampToken(val, idx, fac) {\r\n        var _this = _super.call(this, val, idx, fac) || this;\r\n        _this.val = val;\r\n        _this.idx = idx;\r\n        _this.fac = fac;\r\n        return _this;\r\n    }\r\n    TimestampToken.prototype.Execute = function (val) {\r\n        if (val.string) {\r\n            return new Date(val.string).toISOString();\r\n        }\r\n        else if (val.int) {\r\n            return new Date(Number(val.int) * 1000).toISOString();\r\n        }\r\n    };\r\n    TimestampToken.prototype.Encode = function (args) {\r\n        var val = args.pop();\r\n        return { string: val };\r\n    };\r\n    TimestampToken.prototype.EncodeObject = function (val) {\r\n        return { string: val };\r\n    };\r\n    TimestampToken.prototype.ExtractSchema = function () {\r\n        return TimestampToken.prim;\r\n    };\r\n    // tslint:disable-next-line: variable-name\r\n    TimestampToken.prototype.ToKey = function (_a) {\r\n        var string = _a.string;\r\n        return string;\r\n    };\r\n    TimestampToken.prototype.ToBigMapKey = function (val) {\r\n        return {\r\n            key: { string: val },\r\n            type: { prim: TimestampToken.prim },\r\n        };\r\n    };\r\n    TimestampToken.prim = 'timestamp';\r\n    return TimestampToken;\r\n}(ComparableToken));\n\nvar IntValidationError = /** @class */ (function (_super) {\r\n    __extends(IntValidationError, _super);\r\n    function IntValidationError(value, token, message) {\r\n        var _this = _super.call(this, value, token, message) || this;\r\n        _this.value = value;\r\n        _this.token = token;\r\n        _this.name = 'IntValidationError';\r\n        return _this;\r\n    }\r\n    return IntValidationError;\r\n}(TokenValidationError));\r\nvar IntToken = /** @class */ (function (_super) {\r\n    __extends(IntToken, _super);\r\n    function IntToken(val, idx, fac) {\r\n        var _this = _super.call(this, val, idx, fac) || this;\r\n        _this.val = val;\r\n        _this.idx = idx;\r\n        _this.fac = fac;\r\n        return _this;\r\n    }\r\n    IntToken.prototype.Execute = function (val) {\r\n        return new BigNumber(val[Object.keys(val)[0]]);\r\n    };\r\n    IntToken.prototype.ExtractSchema = function () {\r\n        return IntToken.prim;\r\n    };\r\n    IntToken.prototype.isValid = function (val) {\r\n        var bigNumber = new BigNumber(val);\r\n        if (bigNumber.isNaN()) {\r\n            return new IntValidationError(val, this, \"Value is not a number: \" + val);\r\n        }\r\n        else {\r\n            return null;\r\n        }\r\n    };\r\n    IntToken.prototype.Encode = function (args) {\r\n        var val = args.pop();\r\n        var err = this.isValid(val);\r\n        if (err) {\r\n            throw err;\r\n        }\r\n        return { int: String(val).toString() };\r\n    };\r\n    IntToken.prototype.EncodeObject = function (val) {\r\n        var err = this.isValid(val);\r\n        if (err) {\r\n            throw err;\r\n        }\r\n        return { int: String(val).toString() };\r\n    };\r\n    IntToken.prototype.ToBigMapKey = function (val) {\r\n        return {\r\n            key: { int: val },\r\n            type: { prim: IntToken.prim },\r\n        };\r\n    };\r\n    IntToken.prototype.ToKey = function (_a) {\r\n        var int = _a.int;\r\n        return int;\r\n    };\r\n    IntToken.prim = 'int';\r\n    return IntToken;\r\n}(ComparableToken));\n\nvar UnitToken = /** @class */ (function (_super) {\r\n    __extends(UnitToken, _super);\r\n    function UnitToken(val, idx, fac) {\r\n        var _this = _super.call(this, val, idx, fac) || this;\r\n        _this.val = val;\r\n        _this.idx = idx;\r\n        _this.fac = fac;\r\n        return _this;\r\n    }\r\n    UnitToken.prototype.Encode = function (args) {\r\n        args.pop();\r\n        return { prim: 'Unit' };\r\n    };\r\n    UnitToken.prototype.EncodeObject = function (_val) {\r\n        return { prim: 'Unit' };\r\n    };\r\n    UnitToken.prototype.Execute = function () {\r\n        return UnitValue;\r\n    };\r\n    UnitToken.prototype.ExtractSchema = function () {\r\n        return UnitToken.prim;\r\n    };\r\n    UnitToken.prim = 'unit';\r\n    return UnitToken;\r\n}(Token));\n\nvar KeyValidationError = /** @class */ (function (_super) {\r\n    __extends(KeyValidationError, _super);\r\n    function KeyValidationError(value, token, message) {\r\n        var _this = _super.call(this, value, token, message) || this;\r\n        _this.value = value;\r\n        _this.token = token;\r\n        _this.name = 'KeyValidationError';\r\n        return _this;\r\n    }\r\n    return KeyValidationError;\r\n}(TokenValidationError));\r\nvar KeyToken = /** @class */ (function (_super) {\r\n    __extends(KeyToken, _super);\r\n    function KeyToken(val, idx, fac) {\r\n        var _this = _super.call(this, val, idx, fac) || this;\r\n        _this.val = val;\r\n        _this.idx = idx;\r\n        _this.fac = fac;\r\n        return _this;\r\n    }\r\n    KeyToken.prototype.Execute = function (val) {\r\n        if (val.string) {\r\n            return val.string;\r\n        }\r\n        return encodeKey(val.bytes);\r\n    };\r\n    KeyToken.prototype.isValid = function (value) {\r\n        if (validatePublicKey(value) !== ValidationResult.VALID) {\r\n            return new KeyValidationError(value, this, 'Key is not valid');\r\n        }\r\n        return null;\r\n    };\r\n    KeyToken.prototype.Encode = function (args) {\r\n        var val = args.pop();\r\n        var err = this.isValid(val);\r\n        if (err) {\r\n            throw err;\r\n        }\r\n        return { string: val };\r\n    };\r\n    KeyToken.prototype.EncodeObject = function (val) {\r\n        var err = this.isValid(val);\r\n        if (err) {\r\n            throw err;\r\n        }\r\n        return { string: val };\r\n    };\r\n    KeyToken.prototype.ExtractSchema = function () {\r\n        return KeyToken.prim;\r\n    };\r\n    KeyToken.prim = 'key';\r\n    return KeyToken;\r\n}(Token));\n\nvar KeyHashValidationError = /** @class */ (function (_super) {\r\n    __extends(KeyHashValidationError, _super);\r\n    function KeyHashValidationError(value, token, message) {\r\n        var _this = _super.call(this, value, token, message) || this;\r\n        _this.value = value;\r\n        _this.token = token;\r\n        _this.name = 'KeyHashValidationError';\r\n        return _this;\r\n    }\r\n    return KeyHashValidationError;\r\n}(TokenValidationError));\r\nvar KeyHashToken = /** @class */ (function (_super) {\r\n    __extends(KeyHashToken, _super);\r\n    function KeyHashToken(val, idx, fac) {\r\n        var _this = _super.call(this, val, idx, fac) || this;\r\n        _this.val = val;\r\n        _this.idx = idx;\r\n        _this.fac = fac;\r\n        return _this;\r\n    }\r\n    KeyHashToken.prototype.Execute = function (val) {\r\n        if (val.string) {\r\n            return val.string;\r\n        }\r\n        return encodeKeyHash(val.bytes);\r\n    };\r\n    KeyHashToken.prototype.isValid = function (value) {\r\n        if (validateKeyHash(value) !== ValidationResult.VALID) {\r\n            return new KeyHashValidationError(value, this, \"KeyHash is not valid: \" + value);\r\n        }\r\n        return null;\r\n    };\r\n    KeyHashToken.prototype.Encode = function (args) {\r\n        var val = args.pop();\r\n        var err = this.isValid(val);\r\n        if (err) {\r\n            throw err;\r\n        }\r\n        return { string: val };\r\n    };\r\n    KeyHashToken.prototype.EncodeObject = function (val) {\r\n        var err = this.isValid(val);\r\n        if (err) {\r\n            throw err;\r\n        }\r\n        return { string: val };\r\n    };\r\n    KeyHashToken.prototype.ExtractSchema = function () {\r\n        return KeyHashToken.prim;\r\n    };\r\n    // tslint:disable-next-line: variable-name\r\n    KeyHashToken.prototype.ToKey = function (_a) {\r\n        var string = _a.string, bytes = _a.bytes;\r\n        if (string) {\r\n            return string;\r\n        }\r\n        return encodeKeyHash(bytes);\r\n    };\r\n    KeyHashToken.prototype.ToBigMapKey = function (val) {\r\n        return {\r\n            key: { string: val },\r\n            type: { prim: KeyHashToken.prim },\r\n        };\r\n    };\r\n    KeyHashToken.prim = 'key_hash';\r\n    return KeyHashToken;\r\n}(ComparableToken));\n\nvar SignatureValidationError = /** @class */ (function (_super) {\r\n    __extends(SignatureValidationError, _super);\r\n    function SignatureValidationError(value, token, message) {\r\n        var _this = _super.call(this, value, token, message) || this;\r\n        _this.value = value;\r\n        _this.token = token;\r\n        _this.name = 'SignatureValidationError';\r\n        return _this;\r\n    }\r\n    return SignatureValidationError;\r\n}(TokenValidationError));\r\nvar SignatureToken = /** @class */ (function (_super) {\r\n    __extends(SignatureToken, _super);\r\n    function SignatureToken(val, idx, fac) {\r\n        var _this = _super.call(this, val, idx, fac) || this;\r\n        _this.val = val;\r\n        _this.idx = idx;\r\n        _this.fac = fac;\r\n        return _this;\r\n    }\r\n    SignatureToken.prototype.Execute = function (val) {\r\n        return val.string;\r\n    };\r\n    SignatureToken.prototype.isValid = function (value) {\r\n        if (validateSignature(value) !== ValidationResult.VALID) {\r\n            return new SignatureValidationError(value, this, 'Signature is not valid');\r\n        }\r\n        return null;\r\n    };\r\n    SignatureToken.prototype.Encode = function (args) {\r\n        var val = args.pop();\r\n        var err = this.isValid(val);\r\n        if (err) {\r\n            throw err;\r\n        }\r\n        return { string: val };\r\n    };\r\n    SignatureToken.prototype.EncodeObject = function (val) {\r\n        var err = this.isValid(val);\r\n        if (err) {\r\n            throw err;\r\n        }\r\n        return { string: val };\r\n    };\r\n    SignatureToken.prototype.ExtractSchema = function () {\r\n        return SignatureToken.prim;\r\n    };\r\n    SignatureToken.prim = 'signature';\r\n    return SignatureToken;\r\n}(Token));\n\nvar LambdaToken = /** @class */ (function (_super) {\r\n    __extends(LambdaToken, _super);\r\n    function LambdaToken(val, idx, fac) {\r\n        var _this = _super.call(this, val, idx, fac) || this;\r\n        _this.val = val;\r\n        _this.idx = idx;\r\n        _this.fac = fac;\r\n        return _this;\r\n    }\r\n    LambdaToken.prototype.Execute = function (val) {\r\n        return val.string;\r\n    };\r\n    LambdaToken.prototype.Encode = function (args) {\r\n        var val = args.pop();\r\n        return val;\r\n    };\r\n    LambdaToken.prototype.EncodeObject = function (val) {\r\n        return val;\r\n    };\r\n    LambdaToken.prototype.ExtractSchema = function () {\r\n        var _a;\r\n        var leftToken = this.createToken(this.val.args[0], this.idx);\r\n        var rightToken = this.createToken(this.val.args[1], this.idx + 1);\r\n        return _a = {},\r\n            _a[LambdaToken.prim] = {\r\n                parameters: leftToken.ExtractSchema(),\r\n                returns: rightToken.ExtractSchema(),\r\n            },\r\n            _a;\r\n    };\r\n    LambdaToken.prim = 'lambda';\r\n    return LambdaToken;\r\n}(Token));\n\nvar OperationToken = /** @class */ (function (_super) {\r\n    __extends(OperationToken, _super);\r\n    function OperationToken(val, idx, fac) {\r\n        var _this = _super.call(this, val, idx, fac) || this;\r\n        _this.val = val;\r\n        _this.idx = idx;\r\n        _this.fac = fac;\r\n        return _this;\r\n    }\r\n    OperationToken.prototype.Execute = function (val) {\r\n        return val.string;\r\n    };\r\n    OperationToken.prototype.Encode = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        var val = args.pop();\r\n        return { string: val };\r\n    };\r\n    OperationToken.prototype.EncodeObject = function (val) {\r\n        return { string: val };\r\n    };\r\n    OperationToken.prototype.ExtractSchema = function () {\r\n        return OperationToken.prim;\r\n    };\r\n    OperationToken.prim = 'operation';\r\n    return OperationToken;\r\n}(Token));\n\nvar SetValidationError = /** @class */ (function (_super) {\r\n    __extends(SetValidationError, _super);\r\n    function SetValidationError(value, token, message) {\r\n        var _this = _super.call(this, value, token, message) || this;\r\n        _this.value = value;\r\n        _this.token = token;\r\n        _this.name = 'SetValidationError';\r\n        return _this;\r\n    }\r\n    return SetValidationError;\r\n}(TokenValidationError));\r\nvar SetToken = /** @class */ (function (_super) {\r\n    __extends(SetToken, _super);\r\n    function SetToken(val, idx, fac) {\r\n        var _this = _super.call(this, val, idx, fac) || this;\r\n        _this.val = val;\r\n        _this.idx = idx;\r\n        _this.fac = fac;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(SetToken.prototype, \"KeySchema\", {\r\n        get: function () {\r\n            return this.createToken(this.val.args[0], 0);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    SetToken.prototype.isValid = function (value) {\r\n        if (Array.isArray(value)) {\r\n            return null;\r\n        }\r\n        return new SetValidationError(value, this, 'Value must be an array');\r\n    };\r\n    SetToken.prototype.Encode = function (args) {\r\n        var _this = this;\r\n        var val = args.pop();\r\n        var err = this.isValid(val);\r\n        if (err) {\r\n            throw err;\r\n        }\r\n        return val\r\n            .sort(function (a, b) { return _this.KeySchema.compare(a, b); })\r\n            .reduce(function (prev, current) {\r\n            return __spread(prev, [_this.KeySchema.EncodeObject(current)]);\r\n        }, []);\r\n    };\r\n    SetToken.prototype.Execute = function (val, semantics) {\r\n        var _this = this;\r\n        return val.reduce(function (prev, current) {\r\n            return __spread(prev, [_this.KeySchema.Execute(current, semantics)]);\r\n        }, []);\r\n    };\r\n    SetToken.prototype.EncodeObject = function (args) {\r\n        var _this = this;\r\n        var err = this.isValid(args);\r\n        if (err) {\r\n            throw err;\r\n        }\r\n        return args\r\n            .sort(function (a, b) { return _this.KeySchema.compare(a, b); })\r\n            .reduce(function (prev, current) {\r\n            return __spread(prev, [_this.KeySchema.EncodeObject(current)]);\r\n        }, []);\r\n    };\r\n    SetToken.prototype.ExtractSchema = function () {\r\n        return SetToken.prim;\r\n    };\r\n    SetToken.prim = 'set';\r\n    return SetToken;\r\n}(Token));\n\nvar ChainIDValidationError = /** @class */ (function (_super) {\r\n    __extends(ChainIDValidationError, _super);\r\n    function ChainIDValidationError(value, token, message) {\r\n        var _this = _super.call(this, value, token, message) || this;\r\n        _this.value = value;\r\n        _this.token = token;\r\n        _this.name = 'ChainIDValidationError';\r\n        return _this;\r\n    }\r\n    return ChainIDValidationError;\r\n}(TokenValidationError));\r\nvar ChainIDToken = /** @class */ (function (_super) {\r\n    __extends(ChainIDToken, _super);\r\n    function ChainIDToken(val, idx, fac) {\r\n        var _this = _super.call(this, val, idx, fac) || this;\r\n        _this.val = val;\r\n        _this.idx = idx;\r\n        _this.fac = fac;\r\n        return _this;\r\n    }\r\n    ChainIDToken.prototype.isValid = function (value) {\r\n        if (validateChain(value) !== ValidationResult.VALID) {\r\n            return new ChainIDValidationError(value, this, 'ChainID is not valid');\r\n        }\r\n        return null;\r\n    };\r\n    ChainIDToken.prototype.Execute = function (val) {\r\n        return val[Object.keys(val)[0]];\r\n    };\r\n    ChainIDToken.prototype.ExtractSchema = function () {\r\n        return ChainIDToken.prim;\r\n    };\r\n    ChainIDToken.prototype.Encode = function (args) {\r\n        var val = args.pop();\r\n        var err = this.isValid(val);\r\n        if (err) {\r\n            throw err;\r\n        }\r\n        return { string: val };\r\n    };\r\n    ChainIDToken.prototype.EncodeObject = function (val) {\r\n        var err = this.isValid(val);\r\n        if (err) {\r\n            throw err;\r\n        }\r\n        return { string: val };\r\n    };\r\n    // tslint:disable-next-line: variable-name\r\n    ChainIDToken.prototype.ToKey = function (_a) {\r\n        var string = _a.string;\r\n        return string;\r\n    };\r\n    ChainIDToken.prototype.ToBigMapKey = function (val) {\r\n        return {\r\n            key: { string: val },\r\n            type: { prim: ChainIDToken.prim },\r\n        };\r\n    };\r\n    ChainIDToken.prim = 'chain_id';\r\n    return ChainIDToken;\r\n}(ComparableToken));\n\nvar tokens = [\r\n    PairToken,\r\n    NatToken,\r\n    StringToken,\r\n    BigMapToken,\r\n    AddressToken,\r\n    MapToken,\r\n    BoolToken,\r\n    OrToken,\r\n    ContractToken,\r\n    ListToken,\r\n    MutezToken,\r\n    BytesToken,\r\n    OptionToken,\r\n    TimestampToken,\r\n    IntToken,\r\n    UnitToken,\r\n    KeyToken,\r\n    KeyHashToken,\r\n    SignatureToken,\r\n    LambdaToken,\r\n    OperationToken,\r\n    SetToken,\r\n    ChainIDToken,\r\n];\n\nvar InvalidTokenError = /** @class */ (function () {\r\n    function InvalidTokenError(message, data) {\r\n        this.message = message;\r\n        this.data = data;\r\n        this.name = 'Invalid token error';\r\n    }\r\n    return InvalidTokenError;\r\n}());\r\nfunction createToken(val, idx) {\r\n    var t = tokens.find(function (x) { return x.prim === val.prim; });\r\n    if (!t) {\r\n        throw new InvalidTokenError('Malformed data expected a value with a valid prim property', val);\r\n    }\r\n    return new t(val, idx, createToken);\r\n}\n\nvar _a$1;\r\nvar schemaTypeSymbol = Symbol.for('taquito-schema-type-symbol');\r\n/**\r\n * @warn Our current smart contract abstraction feature is currently in preview. It's API is not final, and it may not cover every use case (yet). We will greatly appreciate any feedback on this feature.\r\n */\r\nvar Schema = /** @class */ (function () {\r\n    function Schema(val) {\r\n        this[_a$1] = true;\r\n        this.root = createToken(val, 0);\r\n        if (this.root instanceof BigMapToken) {\r\n            this.bigMap = this.root;\r\n        }\r\n        else if (this.isExpressionExtended(val) && val.prim === 'pair') {\r\n            var exp = val.args[0];\r\n            if (this.isExpressionExtended(exp) && exp.prim === 'big_map') {\r\n                this.bigMap = new BigMapToken(exp, 0, createToken);\r\n            }\r\n        }\r\n    }\r\n    Schema.isSchema = function (obj) {\r\n        return obj && obj[schemaTypeSymbol] === true;\r\n    };\r\n    Schema.fromRPCResponse = function (val) {\r\n        var storage = val &&\r\n            val.script &&\r\n            Array.isArray(val.script.code) &&\r\n            val.script.code.find(function (x) { return x.prim === 'storage'; });\r\n        if (!storage || !Array.isArray(storage.args)) {\r\n            throw new Error('Invalid rpc response passed as arguments');\r\n        }\r\n        return new Schema(storage.args[0]);\r\n    };\r\n    Schema.prototype.isExpressionExtended = function (val) {\r\n        return 'prim' in val && Array.isArray(val.args);\r\n    };\r\n    Schema.prototype.removeTopLevelAnnotation = function (obj) {\r\n        // PairToken and OrToken can have redundant top level annotation in their storage\r\n        if (this.root instanceof PairToken || this.root instanceof OrToken) {\r\n            if (this.root.hasAnnotations() && typeof obj === 'object' && Object.keys(obj).length === 1) {\r\n                return obj[Object.keys(obj)[0]];\r\n            }\r\n        }\r\n        return obj;\r\n    };\r\n    Schema.prototype.Execute = function (val, semantics) {\r\n        var storage = this.root.Execute(val, semantics);\r\n        return this.removeTopLevelAnnotation(storage);\r\n    };\r\n    Schema.prototype.Typecheck = function (val) {\r\n        try {\r\n            this.root.EncodeObject(val);\r\n            return true;\r\n        }\r\n        catch (ex) {\r\n            return false;\r\n        }\r\n    };\r\n    Schema.prototype.ExecuteOnBigMapDiff = function (diff, semantics) {\r\n        if (!this.bigMap) {\r\n            throw new Error('No big map schema');\r\n        }\r\n        if (!Array.isArray(diff)) {\r\n            throw new Error('Invalid big map diff. It must be an array');\r\n        }\r\n        var eltFormat = diff.map(function (_b) {\r\n            var key = _b.key, value = _b.value;\r\n            return ({ args: [key, value] });\r\n        });\r\n        return this.bigMap.Execute(eltFormat, semantics);\r\n    };\r\n    Schema.prototype.ExecuteOnBigMapValue = function (key, semantics) {\r\n        if (!this.bigMap) {\r\n            throw new Error('No big map schema');\r\n        }\r\n        return this.bigMap.ValueSchema.Execute(key, semantics);\r\n    };\r\n    Schema.prototype.EncodeBigMapKey = function (key) {\r\n        if (!this.bigMap) {\r\n            throw new Error('No big map schema');\r\n        }\r\n        try {\r\n            return this.bigMap.KeySchema.ToBigMapKey(key);\r\n        }\r\n        catch (ex) {\r\n            throw new Error('Unable to encode big map key: ' + ex);\r\n        }\r\n    };\r\n    Schema.prototype.Encode = function (_value) {\r\n        try {\r\n            return this.root.EncodeObject(_value);\r\n        }\r\n        catch (ex) {\r\n            if (ex instanceof TokenValidationError) {\r\n                throw ex;\r\n            }\r\n            throw new Error(\"Unable to encode storage object. \" + ex);\r\n        }\r\n    };\r\n    Schema.prototype.ExtractSchema = function () {\r\n        return this.removeTopLevelAnnotation(this.root.ExtractSchema());\r\n    };\r\n    /**\r\n     * @deprecated\r\n     */\r\n    Schema.prototype.ComputeState = function (tx, state) {\r\n        var _b;\r\n        var _this = this;\r\n        if (!this.bigMap) {\r\n            throw new Error('No big map schema');\r\n        }\r\n        var bigMap = tx.reduce(function (prev, current) {\r\n            return __assign(__assign({}, prev), _this.ExecuteOnBigMapDiff(current.contents[0].metadata.operation_result.big_map_diff));\r\n        }, {});\r\n        return __assign(__assign({}, this.Execute(state)), (_b = {}, _b[this.bigMap.annot()] = bigMap, _b));\r\n    };\r\n    return Schema;\r\n}());\r\n_a$1 = schemaTypeSymbol;\n\n/**\r\n * @warn Our current smart contract abstraction feature is currently in preview. It's API is not final, and it may not cover every use case (yet). We will greatly appreciate any feedback on this feature.\r\n */\r\nvar ParameterSchema = /** @class */ (function () {\r\n    function ParameterSchema(val) {\r\n        this.root = createToken(val, 0);\r\n    }\r\n    ParameterSchema.fromRPCResponse = function (val) {\r\n        var parameter = val &&\r\n            val.script &&\r\n            Array.isArray(val.script.code) &&\r\n            val.script.code.find(function (x) { return x.prim === 'parameter'; });\r\n        if (!parameter || !Array.isArray(parameter.args)) {\r\n            throw new Error('Invalid rpc response passed as arguments');\r\n        }\r\n        return new ParameterSchema(parameter.args[0]);\r\n    };\r\n    Object.defineProperty(ParameterSchema.prototype, \"isMultipleEntryPoint\", {\r\n        get: function () {\r\n            return (this.root instanceof OrToken ||\r\n                (this.root instanceof OptionToken && this.root.subToken() instanceof OrToken));\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ParameterSchema.prototype, \"hasAnnotation\", {\r\n        get: function () {\r\n            if (this.isMultipleEntryPoint) {\r\n                return Object.keys(this.ExtractSchema())[0] !== '0';\r\n            }\r\n            else {\r\n                return true;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    ParameterSchema.prototype.Execute = function (val, semantics) {\r\n        return this.root.Execute(val, semantics);\r\n    };\r\n    ParameterSchema.prototype.Encode = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        try {\r\n            return this.root.Encode(args.reverse());\r\n        }\r\n        catch (ex) {\r\n            if (ex instanceof TokenValidationError) {\r\n                throw ex;\r\n            }\r\n            throw new Error(\"Unable to encode storage object. \" + ex);\r\n        }\r\n    };\r\n    ParameterSchema.prototype.ExtractSchema = function () {\r\n        return this.root.ExtractSchema();\r\n    };\r\n    ParameterSchema.prototype.ExtractSignatures = function () {\r\n        return this.root.ExtractSignature();\r\n    };\r\n    return ParameterSchema;\r\n}());\n\nvar UnitValue = Symbol();\n\nexport { AddressValidationError, BigMapValidationError, BytesValidationError, ChainIDValidationError, ContractValidationError, IntValidationError, KeyHashValidationError, KeyValidationError, ListValidationError, MapTypecheckError, MapValidationError, MichelsonMap, MutezValidationError, NatValidationError, ParameterSchema, Schema, SetValidationError, SignatureValidationError, UnitValue };\n//# sourceMappingURL=taquito-michelson-encoder.es5.js.map\n"]},"metadata":{},"sourceType":"module"}