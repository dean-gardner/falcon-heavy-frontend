{"ast":null,"code":"/** PURE_IMPORTS_START tslib,_Subject,_Subscription,_OuterSubscriber,_util_subscribeToResult PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Subject } from '../Subject';\nimport { Subscription } from '../Subscription';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\nexport function windowToggle(openings, closingSelector) {\n  return function (source) {\n    return source.lift(new WindowToggleOperator(openings, closingSelector));\n  };\n}\n\nvar WindowToggleOperator = /*@__PURE__*/function () {\n  function WindowToggleOperator(openings, closingSelector) {\n    this.openings = openings;\n    this.closingSelector = closingSelector;\n  }\n\n  WindowToggleOperator.prototype.call = function (subscriber, source) {\n    return source.subscribe(new WindowToggleSubscriber(subscriber, this.openings, this.closingSelector));\n  };\n\n  return WindowToggleOperator;\n}();\n\nvar WindowToggleSubscriber = /*@__PURE__*/function (_super) {\n  tslib_1.__extends(WindowToggleSubscriber, _super);\n\n  function WindowToggleSubscriber(destination, openings, closingSelector) {\n    var _this = _super.call(this, destination) || this;\n\n    _this.openings = openings;\n    _this.closingSelector = closingSelector;\n    _this.contexts = [];\n\n    _this.add(_this.openSubscription = subscribeToResult(_this, openings, openings));\n\n    return _this;\n  }\n\n  WindowToggleSubscriber.prototype._next = function (value) {\n    var contexts = this.contexts;\n\n    if (contexts) {\n      var len = contexts.length;\n\n      for (var i = 0; i < len; i++) {\n        contexts[i].window.next(value);\n      }\n    }\n  };\n\n  WindowToggleSubscriber.prototype._error = function (err) {\n    var contexts = this.contexts;\n    this.contexts = null;\n\n    if (contexts) {\n      var len = contexts.length;\n      var index = -1;\n\n      while (++index < len) {\n        var context_1 = contexts[index];\n        context_1.window.error(err);\n        context_1.subscription.unsubscribe();\n      }\n    }\n\n    _super.prototype._error.call(this, err);\n  };\n\n  WindowToggleSubscriber.prototype._complete = function () {\n    var contexts = this.contexts;\n    this.contexts = null;\n\n    if (contexts) {\n      var len = contexts.length;\n      var index = -1;\n\n      while (++index < len) {\n        var context_2 = contexts[index];\n        context_2.window.complete();\n        context_2.subscription.unsubscribe();\n      }\n    }\n\n    _super.prototype._complete.call(this);\n  };\n\n  WindowToggleSubscriber.prototype._unsubscribe = function () {\n    var contexts = this.contexts;\n    this.contexts = null;\n\n    if (contexts) {\n      var len = contexts.length;\n      var index = -1;\n\n      while (++index < len) {\n        var context_3 = contexts[index];\n        context_3.window.unsubscribe();\n        context_3.subscription.unsubscribe();\n      }\n    }\n  };\n\n  WindowToggleSubscriber.prototype.notifyNext = function (outerValue, innerValue, outerIndex, innerIndex, innerSub) {\n    if (outerValue === this.openings) {\n      var closingNotifier = void 0;\n\n      try {\n        var closingSelector = this.closingSelector;\n        closingNotifier = closingSelector(innerValue);\n      } catch (e) {\n        return this.error(e);\n      }\n\n      var window_1 = new Subject();\n      var subscription = new Subscription();\n      var context_4 = {\n        window: window_1,\n        subscription: subscription\n      };\n      this.contexts.push(context_4);\n      var innerSubscription = subscribeToResult(this, closingNotifier, context_4);\n\n      if (innerSubscription.closed) {\n        this.closeWindow(this.contexts.length - 1);\n      } else {\n        innerSubscription.context = context_4;\n        subscription.add(innerSubscription);\n      }\n\n      this.destination.next(window_1);\n    } else {\n      this.closeWindow(this.contexts.indexOf(outerValue));\n    }\n  };\n\n  WindowToggleSubscriber.prototype.notifyError = function (err) {\n    this.error(err);\n  };\n\n  WindowToggleSubscriber.prototype.notifyComplete = function (inner) {\n    if (inner !== this.openSubscription) {\n      this.closeWindow(this.contexts.indexOf(inner.context));\n    }\n  };\n\n  WindowToggleSubscriber.prototype.closeWindow = function (index) {\n    if (index === -1) {\n      return;\n    }\n\n    var contexts = this.contexts;\n    var context = contexts[index];\n    var window = context.window,\n        subscription = context.subscription;\n    contexts.splice(index, 1);\n    window.complete();\n    subscription.unsubscribe();\n  };\n\n  return WindowToggleSubscriber;\n}(OuterSubscriber);","map":{"version":3,"mappings":"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","names":["tslib_1","Subject","Subscription","OuterSubscriber","subscribeToResult","windowToggle","openings","closingSelector","source","lift","WindowToggleOperator","prototype","call","subscriber","subscribe","WindowToggleSubscriber","_super","__extends","destination","_this","contexts","add","openSubscription","_next","value","len","length","i","window","next","_error","err","index","context_1","error","subscription","unsubscribe","_complete","context_2","complete","_unsubscribe","context_3","notifyNext","outerValue","innerValue","outerIndex","innerIndex","innerSub","closingNotifier","e","window_1","context_4","push","innerSubscription","closed","closeWindow","context","indexOf","notifyError","notifyComplete","inner","splice"],"sources":["D:/work/projects/plenty/falcon-heavy-frontend/node_modules/rxjs/_esm5/internal/operators/windowToggle.js"],"sourcesContent":["/** PURE_IMPORTS_START tslib,_Subject,_Subscription,_OuterSubscriber,_util_subscribeToResult PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Subject } from '../Subject';\nimport { Subscription } from '../Subscription';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\nexport function windowToggle(openings, closingSelector) {\n    return function (source) { return source.lift(new WindowToggleOperator(openings, closingSelector)); };\n}\nvar WindowToggleOperator = /*@__PURE__*/ (function () {\n    function WindowToggleOperator(openings, closingSelector) {\n        this.openings = openings;\n        this.closingSelector = closingSelector;\n    }\n    WindowToggleOperator.prototype.call = function (subscriber, source) {\n        return source.subscribe(new WindowToggleSubscriber(subscriber, this.openings, this.closingSelector));\n    };\n    return WindowToggleOperator;\n}());\nvar WindowToggleSubscriber = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(WindowToggleSubscriber, _super);\n    function WindowToggleSubscriber(destination, openings, closingSelector) {\n        var _this = _super.call(this, destination) || this;\n        _this.openings = openings;\n        _this.closingSelector = closingSelector;\n        _this.contexts = [];\n        _this.add(_this.openSubscription = subscribeToResult(_this, openings, openings));\n        return _this;\n    }\n    WindowToggleSubscriber.prototype._next = function (value) {\n        var contexts = this.contexts;\n        if (contexts) {\n            var len = contexts.length;\n            for (var i = 0; i < len; i++) {\n                contexts[i].window.next(value);\n            }\n        }\n    };\n    WindowToggleSubscriber.prototype._error = function (err) {\n        var contexts = this.contexts;\n        this.contexts = null;\n        if (contexts) {\n            var len = contexts.length;\n            var index = -1;\n            while (++index < len) {\n                var context_1 = contexts[index];\n                context_1.window.error(err);\n                context_1.subscription.unsubscribe();\n            }\n        }\n        _super.prototype._error.call(this, err);\n    };\n    WindowToggleSubscriber.prototype._complete = function () {\n        var contexts = this.contexts;\n        this.contexts = null;\n        if (contexts) {\n            var len = contexts.length;\n            var index = -1;\n            while (++index < len) {\n                var context_2 = contexts[index];\n                context_2.window.complete();\n                context_2.subscription.unsubscribe();\n            }\n        }\n        _super.prototype._complete.call(this);\n    };\n    WindowToggleSubscriber.prototype._unsubscribe = function () {\n        var contexts = this.contexts;\n        this.contexts = null;\n        if (contexts) {\n            var len = contexts.length;\n            var index = -1;\n            while (++index < len) {\n                var context_3 = contexts[index];\n                context_3.window.unsubscribe();\n                context_3.subscription.unsubscribe();\n            }\n        }\n    };\n    WindowToggleSubscriber.prototype.notifyNext = function (outerValue, innerValue, outerIndex, innerIndex, innerSub) {\n        if (outerValue === this.openings) {\n            var closingNotifier = void 0;\n            try {\n                var closingSelector = this.closingSelector;\n                closingNotifier = closingSelector(innerValue);\n            }\n            catch (e) {\n                return this.error(e);\n            }\n            var window_1 = new Subject();\n            var subscription = new Subscription();\n            var context_4 = { window: window_1, subscription: subscription };\n            this.contexts.push(context_4);\n            var innerSubscription = subscribeToResult(this, closingNotifier, context_4);\n            if (innerSubscription.closed) {\n                this.closeWindow(this.contexts.length - 1);\n            }\n            else {\n                innerSubscription.context = context_4;\n                subscription.add(innerSubscription);\n            }\n            this.destination.next(window_1);\n        }\n        else {\n            this.closeWindow(this.contexts.indexOf(outerValue));\n        }\n    };\n    WindowToggleSubscriber.prototype.notifyError = function (err) {\n        this.error(err);\n    };\n    WindowToggleSubscriber.prototype.notifyComplete = function (inner) {\n        if (inner !== this.openSubscription) {\n            this.closeWindow(this.contexts.indexOf(inner.context));\n        }\n    };\n    WindowToggleSubscriber.prototype.closeWindow = function (index) {\n        if (index === -1) {\n            return;\n        }\n        var contexts = this.contexts;\n        var context = contexts[index];\n        var window = context.window, subscription = context.subscription;\n        contexts.splice(index, 1);\n        window.complete();\n        subscription.unsubscribe();\n    };\n    return WindowToggleSubscriber;\n}(OuterSubscriber));\n//# sourceMappingURL=windowToggle.js.map\n"]},"metadata":{},"sourceType":"module"}